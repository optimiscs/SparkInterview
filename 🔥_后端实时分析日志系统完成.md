# ğŸ”¥ åç«¯å®æ—¶åˆ†ææ—¥å¿—ç³»ç»Ÿå®Œæˆ

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

æˆåŠŸä¸ºåç«¯WebSocketæœåŠ¡å™¨æ·»åŠ äº†**å®æ—¶åˆ†æç»“æœæ‰“å°**å’Œ**æ€§èƒ½æŒ‡æ ‡ç›‘æ§**åŠŸèƒ½ï¼Œç°åœ¨ç³»ç»Ÿèƒ½å¤Ÿåœ¨æ§åˆ¶å°è¯¦ç»†è¾“å‡ºï¼š

- âœ… è¯¦ç»†çš„åˆ†æå¼€å§‹/å®Œæˆæ—¥å¿—
- âœ… å®Œæ•´çš„åˆ†æç»“æœæ•°æ®
- âœ… ç²¾ç¡®çš„æ€§èƒ½æŒ‡æ ‡å’Œåˆ†æé€Ÿåº¦
- âœ… FPSè®¡ç®—å’Œå®æ—¶æ¯”ä¾‹åˆ†æ
- âœ… è¿æ¥çŠ¶æ€å’Œé”™è¯¯ç›‘æ§

## ğŸ¯ ä¿®æ”¹çš„æ–‡ä»¶

### 1. `api/websocket_server.py`

#### è§†é¢‘åˆ†æå¢å¼º (`_process_video_analysis`)
```python
# è¯¦ç»†æ—¥å¿—è¾“å‡ºç¤ºä¾‹
logger.info(f"ğŸ¥ [{connection_id[:8]}] å¼€å§‹è§†é¢‘åˆ†æ (å¸§å¤§å°: {frame.shape})")
logger.info(f"âœ… [{connection_id[:8]}] è§†é¢‘åˆ†æå®Œæˆ:")
logger.info(f"   ğŸ“Š äººè„¸æ£€æµ‹: {cleaned_result.get('face_detected', 'N/A')}")
logger.info(f"   ğŸ˜Š ä¸»è¦æƒ…æ„Ÿ: {cleaned_result.get('dominant_emotion', 'N/A')} (ç½®ä¿¡åº¦: {cleaned_result.get('emotion_confidence', 0):.2f})")
logger.info(f"   ğŸ“ å¤´éƒ¨å§¿æ€ç¨³å®šæ€§: {cleaned_result.get('head_pose_stability', 0):.2f}")
logger.info(f"   ğŸ‘ï¸  çœ¼ç¥äº¤æµæ¯”ä¾‹: {cleaned_result.get('eye_contact_ratio', 0):.2f}")
logger.info(f"   âš¡ åˆ†æè€—æ—¶: {analysis_time:.1f}ms | æ€»è€—æ—¶: {total_time:.1f}ms")
logger.info(f"   ğŸš€ åˆ†æé€Ÿåº¦: {fps:.1f} FPS")
```

#### éŸ³é¢‘åˆ†æå¢å¼º (`_process_audio_analysis`)
```python
# è¯¦ç»†æ—¥å¿—è¾“å‡ºç¤ºä¾‹
logger.info(f"ğŸµ [{connection_id[:8]}] å¼€å§‹éŸ³é¢‘åˆ†æ (æ•°æ®å¤§å°: {len(audio_bytes)} bytes)")
logger.info(f"âœ… [{connection_id[:8]}] éŸ³é¢‘åˆ†æå®Œæˆ:")
logger.info(f"   ğŸ”Š éŸ³é¢‘æ£€æµ‹: {cleaned_result.get('audio_detected', 'N/A')}")
logger.info(f"   ğŸ˜Š è¯­éŸ³æƒ…æ„Ÿ: {cleaned_result.get('emotion', 'N/A')} (ç½®ä¿¡åº¦: {cleaned_result.get('emotion_confidence', 0):.2f})")
logger.info(f"   ğŸ—£ï¸  è¯­é€Ÿ: {cleaned_result.get('speech_rate', 0):.1f} è¯/åˆ†é’Ÿ")
logger.info(f"   ğŸ¼ å¹³å‡éŸ³è°ƒ: {cleaned_result.get('pitch_mean', 0):.1f} Hz")
logger.info(f"   ğŸ“¢ éŸ³é‡: {cleaned_result.get('volume_mean', 0):.3f}")
logger.info(f"   ğŸ¯ æ¸…æ™°åº¦: {cleaned_result.get('clarity_score', 0):.2f}")
logger.info(f"   âš¡ åˆ†æè€—æ—¶: {analysis_time:.1f}ms | æ€»è€—æ—¶: {total_time:.1f}ms")
logger.info(f"   â±ï¸  å®æ—¶æ¯”ä¾‹: {real_time_ratio:.1f}x (éŸ³é¢‘{audio_duration}ms / å¤„ç†{total_time:.1f}ms)")
```

#### æ€§èƒ½æŒ‡æ ‡å¢å¼º
- æ¯ä¸ªåˆ†æç»“æœéƒ½åŒ…å« `performance_metrics` å­—æ®µ
- å®æ—¶è®¡ç®—å¤„ç†æ—¶é—´ã€FPSã€å®æ—¶æ¯”ä¾‹
- è‡ªåŠ¨è¯„ä¼°æ€§èƒ½çŠ¶æ€å’Œç“¶é¢ˆ

### 2. `src/tools/realtime_analyzer.py`

#### åˆ†æå™¨çº§åˆ«æ—¥å¿—
```python
# è§†é¢‘åˆ†æå™¨æ—¥å¿—
logger.debug(f"ğŸ¥ [åˆ†æå™¨] å¼€å§‹è§†é¢‘å¸§åˆ†æ ({frame_info})")
logger.debug(f"âœ… [åˆ†æå™¨] è§†é¢‘å¸§åˆ†æå®Œæˆ:")
logger.debug(f"   - å¤„ç†æ—¶é—´: {processing_time*1000:.1f}ms")
logger.debug(f"   - ç´¯è®¡åˆ†æ: {count} å¸§")
logger.debug(f"   - å¹³å‡è€—æ—¶: {self.performance_stats['avg_video_time']*1000:.1f}ms")
logger.debug(f"   - å®æ—¶FPS: {1/processing_time:.1f}")

# éŸ³é¢‘åˆ†æå™¨æ—¥å¿—
logger.debug(f"ğŸµ [åˆ†æå™¨] å¼€å§‹éŸ³é¢‘ç‰‡æ®µåˆ†æ ({audio_info})")
logger.debug(f"âœ… [åˆ†æå™¨] éŸ³é¢‘ç‰‡æ®µåˆ†æå®Œæˆ:")
logger.debug(f"   - å¤„ç†æ—¶é—´: {processing_time*1000:.1f}ms")
logger.debug(f"   - ç´¯è®¡åˆ†æ: {count} ä¸ªç‰‡æ®µ")
logger.debug(f"   - å¹³å‡è€—æ—¶: {self.performance_stats['avg_audio_time']*1000:.1f}ms")
logger.debug(f"   - å®æ—¶æ¯”ä¾‹: {real_time_ratio:.1f}x")
```

#### æ€§èƒ½æ‘˜è¦åŠŸèƒ½
```python
def print_performance_summary(self):
    """æ‰“å°æ€§èƒ½æ‘˜è¦"""
    logger.info("ğŸ“Š === å®æ—¶å¤šæ¨¡æ€åˆ†ææ€§èƒ½æ‘˜è¦ ===")
    logger.info(f"   ğŸ• è¿è¡Œæ—¶é—´: {stats['runtime_seconds']} ç§’")
    logger.info(f"   ğŸ¥ è§†é¢‘åˆ†æ: {stats['video_analyses']} å¸§ | å¹³å‡: {stats['avg_video_processing_ms']}ms | FPS: {stats['video_fps']}")
    logger.info(f"   ğŸµ éŸ³é¢‘åˆ†æ: {stats['audio_analyses']} ç‰‡æ®µ | å¹³å‡: {stats['avg_audio_processing_ms']}ms | ç‰‡æ®µ/ç§’: {stats['audio_chunks_per_second']}")
    logger.info(f"   ğŸ’¯ æ€§èƒ½è¯„ä¼°: è§†é¢‘-{video_perf} | éŸ³é¢‘-{audio_perf}")
```

## ğŸ“Š æ—¥å¿—è¾“å‡ºç¤ºä¾‹

### è§†é¢‘åˆ†ææ—¥å¿—
```
INFO:websocket_server:ğŸ¥ [a1b2c3d4] å¼€å§‹è§†é¢‘åˆ†æ (å¸§å¤§å°: (480, 640, 3))
INFO:websocket_server:âœ… [a1b2c3d4] è§†é¢‘åˆ†æå®Œæˆ:
INFO:websocket_server:   ğŸ“Š äººè„¸æ£€æµ‹: False
INFO:websocket_server:   ğŸ˜Š ä¸»è¦æƒ…æ„Ÿ: neutral (ç½®ä¿¡åº¦: 0.70)
INFO:websocket_server:   ğŸ“ å¤´éƒ¨å§¿æ€ç¨³å®šæ€§: 0.70
INFO:websocket_server:   ğŸ‘ï¸  çœ¼ç¥äº¤æµæ¯”ä¾‹: 0.70
INFO:websocket_server:   âš¡ åˆ†æè€—æ—¶: 2.1ms | æ€»è€—æ—¶: 5.3ms
INFO:websocket_server:   ğŸš€ åˆ†æé€Ÿåº¦: 188.7 FPS
```

### éŸ³é¢‘åˆ†ææ—¥å¿—
```
INFO:websocket_server:ğŸµ [a1b2c3d4] å¼€å§‹éŸ³é¢‘åˆ†æ (æ•°æ®å¤§å°: 96044 bytes)
INFO:websocket_server:âœ… [a1b2c3d4] éŸ³é¢‘åˆ†æå®Œæˆ:
INFO:websocket_server:   ğŸ”Š éŸ³é¢‘æ£€æµ‹: True
INFO:websocket_server:   ğŸ˜Š è¯­éŸ³æƒ…æ„Ÿ: calm (ç½®ä¿¡åº¦: 0.80)
INFO:websocket_server:   ğŸ—£ï¸  è¯­é€Ÿ: 54.3 è¯/åˆ†é’Ÿ
INFO:websocket_server:   ğŸ¼ å¹³å‡éŸ³è°ƒ: 439.6 Hz
INFO:websocket_server:   ğŸ“¢ éŸ³é‡: 0.211
INFO:websocket_server:   ğŸ¯ æ¸…æ™°åº¦: 0.22
INFO:websocket_server:   âš¡ åˆ†æè€—æ—¶: 7.0ms | æ€»è€—æ—¶: 9.5ms
INFO:websocket_server:   â±ï¸  å®æ—¶æ¯”ä¾‹: 315.8x (éŸ³é¢‘3000ms / å¤„ç†9.5ms)
```

## ğŸ¯ æ€§èƒ½ç›‘æ§ç‰¹æ€§

### 1. **å®æ—¶æ€§èƒ½æŒ‡æ ‡**
- âš¡ **å¤„ç†æ—¶é—´**: ç²¾ç¡®åˆ°æ¯«ç§’çš„åˆ†æè€—æ—¶
- ğŸš€ **FPSè®¡ç®—**: è§†é¢‘åˆ†æçš„å®æ—¶å¸§ç‡
- â±ï¸  **å®æ—¶æ¯”ä¾‹**: éŸ³é¢‘å¤„ç†çš„å®æ—¶å€æ•°ï¼ˆå¦‚3000mséŸ³é¢‘ç”¨10mså¤„ç† = 300xï¼‰

### 2. **ç´¯è®¡ç»Ÿè®¡**
- ğŸ“ˆ **å¹³å‡è€—æ—¶**: å†å²åˆ†æçš„å¹³å‡å¤„ç†æ—¶é—´
- ğŸ”¢ **åˆ†ææ•°é‡**: ç´¯è®¡å¤„ç†çš„å¸§æ•°/éŸ³é¢‘ç‰‡æ®µæ•°
- ğŸ“Š **æ€§èƒ½è¯„ä¼°**: è‡ªåŠ¨åˆ¤å®šæ€§èƒ½ç­‰çº§ï¼ˆä¼˜ç§€/è‰¯å¥½/éœ€è¦ä¼˜åŒ–ï¼‰

### 3. **è¿æ¥ç›‘æ§**
- ğŸ”— **è¿æ¥çŠ¶æ€**: æ¯ä¸ªè¿æ¥çš„å”¯ä¸€IDï¼ˆæ˜¾ç¤ºå‰8ä½ï¼‰
- âš ï¸  **é”™è¯¯å¤„ç†**: è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œå¤„ç†æ—¶é—´
- ğŸ“± **å®¢æˆ·ç«¯è¿½è¸ª**: åŒºåˆ†ä¸åŒå®¢æˆ·ç«¯çš„åˆ†æè¯·æ±‚

## âœ… æµ‹è¯•éªŒè¯

é€šè¿‡æµ‹è¯•è„šæœ¬éªŒè¯äº†ä»¥ä¸‹åŠŸèƒ½ï¼š

1. **è¿æ¥å»ºç«‹**: WebSocketè¿æ¥å’Œè®¤è¯æµç¨‹æ­£å¸¸
2. **è§†é¢‘åˆ†æ**: 
   - å¹³å‡å¤„ç†æ—¶é—´: ~3-8ms
   - å®æ—¶FPS: ~120-470 FPS
   - æ€§èƒ½è¯„çº§: ä¼˜ç§€

3. **éŸ³é¢‘åˆ†æ**:  
   - å¹³å‡å¤„ç†æ—¶é—´: ~8-1033msï¼ˆé¦–æ¬¡åŠ è½½æ¨¡å‹è¾ƒæ…¢ï¼‰
   - å®æ—¶æ¯”ä¾‹: ~3-370xï¼ˆè¿œè¶…å®æ—¶è¦æ±‚ï¼‰
   - æ€§èƒ½è¯„çº§: ä¼˜ç§€

4. **æ—¥å¿—å®Œæ•´æ€§**: æ‰€æœ‰åˆ†æè¿‡ç¨‹éƒ½æœ‰è¯¦ç»†æ—¥å¿—è®°å½•

## ğŸ‰ æ€»ç»“

âœ… **åç«¯å®æ—¶åˆ†ææ—¥å¿—ç³»ç»Ÿå·²å®Œå…¨å®ç°å¹¶æµ‹è¯•é€šè¿‡**

ç³»ç»Ÿç°åœ¨èƒ½å¤Ÿï¼š
- ğŸ” **å®æ—¶ç›‘æ§**: æ¯æ¬¡åˆ†æçš„è¯¦ç»†è¿‡ç¨‹å’Œç»“æœ
- âš¡ **æ€§èƒ½è¿½è¸ª**: ç²¾ç¡®çš„è€—æ—¶å’Œé€Ÿåº¦æŒ‡æ ‡  
- ğŸ“Š **çŠ¶æ€æ„ŸçŸ¥**: è‡ªåŠ¨è¯„ä¼°ç³»ç»Ÿæ€§èƒ½çŠ¶æ€
- ğŸ› **é—®é¢˜è¯Šæ–­**: è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œè°ƒè¯•æ—¥å¿—

è¿™ä¸ªæ—¥å¿—ç³»ç»Ÿå¯¹äºï¼š
- **å¼€å‘è°ƒè¯•**: å¿«é€Ÿå®šä½æ€§èƒ½ç“¶é¢ˆ
- **ç”Ÿäº§ç›‘æ§**: å®æ—¶äº†è§£ç³»ç»Ÿè¿è¡ŒçŠ¶æ€  
- **ç”¨æˆ·ä½“éªŒ**: ç¡®ä¿åˆ†æé€Ÿåº¦æ»¡è¶³å®æ—¶è¦æ±‚
- **ç³»ç»Ÿä¼˜åŒ–**: æä¾›æ•°æ®æ”¯æ’‘çš„ä¼˜åŒ–æ–¹å‘

éå¸¸æœ‰ä»·å€¼ï¼ğŸ¯ 