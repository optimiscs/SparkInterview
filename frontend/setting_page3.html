<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>èŒé¢æ˜Ÿç« - é¢˜ç›®ç”Ÿæˆ</title>
<script src="https://cdn.tailwindcss.com/3.4.16"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css">
<script>
tailwind.config = {
theme: {
extend: {
colors: {
primary: '#3b82f6',
secondary: '#6366f1'
},
borderRadius: {
'none': '0px',
'sm': '4px',
DEFAULT: '8px',
'md': '12px',
'lg': '16px',
'xl': '20px',
'2xl': '24px',
'3xl': '32px',
'full': '9999px',
'button': '8px'
}
}
}
}
</script>
<style>
:where([class^="ri-"])::before {
content: "\f3c2";
}
.fade-in {
animation: fadeIn 0.5s ease-in;
}
@keyframes fadeIn {
from { opacity: 0; transform: translateY(10px); }
to { opacity: 1; transform: translateY(0); }
}
.skill-tag {
transition: all 0.2s ease;
cursor: pointer;
}
.skill-tag:hover {
transform: translateY(-1px);
box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.skill-tag.selected {
background-color: #3b82f6;
color: white;
}
.question-card {
transition: all 0.3s ease;
}
.question-card:hover {
transform: translateY(-2px);
box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}
.slider-track {
background: linear-gradient(to right, #10b981 0%, #f59e0b 50%, #ef4444 100%);
}
.slider-thumb {
transition: all 0.2s ease;
}
.slider-thumb:hover {
transform: scale(1.1);
}
.loading-spinner {
animation: spin 1s linear infinite;
}
@keyframes spin {
from { transform: rotate(0deg); }
to { transform: rotate(360deg); }
}
.checkbox-custom {
appearance: none;
width: 1.25rem;
height: 1.25rem;
border: 2px solid #d1d5db;
border-radius: 4px;
position: relative;
cursor: pointer;
transition: all 0.2s ease;
}
.checkbox-custom:checked {
background-color: #3b82f6;
border-color: #3b82f6;
}
.checkbox-custom:checked::after {
content: 'âœ“';
position: absolute;
top: 50%;
left: 50%;
transform: translate(-50%, -50%);
color: white;
font-size: 0.75rem;
font-weight: bold;
}
.switch-custom {
width: 3rem;
height: 1.5rem;
background-color: #d1d5db;
border-radius: 9999px;
position: relative;
cursor: pointer;
transition: all 0.3s ease;
}
.switch-custom.active {
background-color: #3b82f6;
}
.switch-thumb {
width: 1.25rem;
height: 1.25rem;
background-color: white;
border-radius: 50%;
position: absolute;
top: 0.125rem;
left: 0.125rem;
transition: all 0.3s ease;
box-shadow: 0 1px 3px rgba(0,0,0,0.3);
}
.switch-custom.active .switch-thumb {
transform: translateX(1.5rem);
}
</style>
<!-- å¯¼èˆªæ å®¹å™¨ - ç»„ä»¶ä¼šè‡ªåŠ¨æ’å…¥åˆ°è¿™é‡Œ -->
    <div id="navbar-container"></div>
</head>
<body class="bg-gray-50 min-h-screen">
<div class="flex h-screen flex-col">
<!-- å¯¼èˆªæ å®¹å™¨ - ç»„ä»¶ä¼šè‡ªåŠ¨æ’å…¥åˆ°è¿™é‡Œ -->
    <div id="navbar-container"></div>

<!-- ä¸»è¦å†…å®¹åŒº -->
<div class="flex-1 flex overflow-hidden bg-gray-50">
<!-- å·¦ä¾§ä¸»è¦å†…å®¹åŒº -->
<div class="flex-1 flex flex-col overflow-hidden">
<div class="bg-white border-b border-gray-200 px-8 py-6">
<h1 class="text-2xl font-bold text-gray-900">é¢˜ç›®ç”Ÿæˆ</h1>
<p class="text-gray-600 mt-1">åŸºäºç®€å†è§£æç»“æœï¼Œæ™ºèƒ½ç”Ÿæˆä¸ªæ€§åŒ–é¢è¯•é¢˜ç›®</p>
</div>

<!-- è¿›åº¦æŒ‡ç¤ºå™¨ -->
<div class="bg-white border-b border-gray-200 px-8 py-4">
<div class="flex items-center justify-between">
<div class="flex items-center">
<div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center text-white text-sm font-medium">
<i class="ri-check-line"></i>
</div>
<span class="ml-2 text-sm font-medium text-green-600">åŸºç¡€ä¿¡æ¯</span>
</div>
<div class="flex-1 mx-4 h-px bg-green-300"></div>
<div class="flex items-center">
<div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center text-white text-sm font-medium">
<i class="ri-check-line"></i>
</div>
<span class="ml-2 text-sm font-medium text-green-600">ç®€å†è§£æ</span>
</div>
<div class="flex-1 mx-4 h-px bg-primary"></div>
<div class="flex items-center">
<div class="w-8 h-8 bg-primary rounded-full flex items-center justify-center text-white text-sm font-medium">3</div>
<span class="ml-2 text-sm font-medium text-primary">é¢˜ç›®ç”Ÿæˆ</span>
</div>
</div>
</div>

<div class="flex-1 flex overflow-hidden">
<!-- æŠ€èƒ½å’Œé¡¹ç›®å±•ç¤ºåŒº -->
<div class="flex-1 p-8 overflow-y-auto">
<div class="space-y-8">
<!-- æŠ€èƒ½æ ‡ç­¾åŒºåŸŸ -->
<div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
<h3 class="text-lg font-semibold text-gray-900 mb-4">è¯†åˆ«çš„æŠ€èƒ½ç‚¹</h3>
<div class="flex flex-wrap gap-2" id="skillsContainer">
<!-- æŠ€èƒ½æ ‡ç­¾å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
</div>
<p class="text-sm text-gray-500 mt-3">ç‚¹å‡»æŠ€èƒ½æ ‡ç­¾å¯é€‰æ‹©é‡ç‚¹è€ƒå¯Ÿçš„æŠ€èƒ½</p>
</div>

<!-- é¡¹ç›®ç»éªŒåŒºåŸŸ -->
<div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6">
<h3 class="text-lg font-semibold text-gray-900 mb-4">é¡¹ç›®ç»éªŒ</h3>
<div class="space-y-4" id="projectsContainer">
<!-- é¡¹ç›®ç»éªŒå°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
</div>
<p class="text-sm text-gray-500 mt-3">é€‰æ‹©é¡¹ç›®ç»éªŒå¯ç”Ÿæˆç›¸å…³çš„é¡¹ç›®é¢˜ç›®</p>
</div>

<!-- ç”Ÿæˆçš„é¢˜ç›®åˆ—è¡¨ -->
<div id="questionsList" class="space-y-4">
<!-- é¢˜ç›®å°†é€šè¿‡ JavaScript åŠ¨æ€ç”Ÿæˆ -->
</div>
</div>
</div>

<!-- å³ä¾§é¢˜ç›®ç”Ÿæˆæ§åˆ¶é¢æ¿ -->
<div class="w-96 bg-white border-l border-gray-200 p-6 overflow-y-auto">
<h3 class="text-lg font-semibold text-gray-900 mb-6">é¢˜ç›®ç”Ÿæˆè®¾ç½®</h3>

<!-- é¢˜ç›®ç±»å‹é€‰æ‹© -->
<div class="mb-8">
<h4 class="text-sm font-medium text-gray-900 mb-4">é¢˜ç›®ç±»å‹</h4>
<div class="space-y-3">
<label class="flex items-center cursor-pointer">
<input type="checkbox" class="checkbox-custom mr-3" id="techBasic" checked>
<span class="text-sm text-gray-700">æŠ€æœ¯åŸºç¡€é¢˜</span>
</label>
<label class="flex items-center cursor-pointer">
<input type="checkbox" class="checkbox-custom mr-3" id="projectExp" checked>
<span class="text-sm text-gray-700">é¡¹ç›®ç»éªŒé¢˜</span>
</label>
<label class="flex items-center cursor-pointer">
<input type="checkbox" class="checkbox-custom mr-3" id="algorithm">
<span class="text-sm text-gray-700">ç®—æ³•è®¾è®¡é¢˜</span>
</label>
<label class="flex items-center cursor-pointer">
<input type="checkbox" class="checkbox-custom mr-3" id="systemDesign">
<span class="text-sm text-gray-700">ç³»ç»Ÿè®¾è®¡é¢˜</span>
</label>
</div>
</div>

<!-- éš¾åº¦è°ƒèŠ‚ -->
<div class="mb-8">
<h4 class="text-sm font-medium text-gray-900 mb-4">é¢˜ç›®éš¾åº¦</h4>
<div class="space-y-4">
<div class="relative">
<input type="range" min="1" max="3" value="2" class="w-full h-2 slider-track rounded-full appearance-none cursor-pointer" id="difficultySlider">
<div class="flex justify-between text-xs text-gray-500 mt-2">
<span>åˆçº§</span>
<span>ä¸­çº§</span>
<span>é«˜çº§</span>
</div>
</div>
<div class="bg-gray-50 rounded-lg p-3">
<div class="text-sm font-medium text-gray-900 mb-1" id="difficultyLabel">ä¸­çº§</div>
<div class="text-xs text-gray-600" id="difficultyDesc">é€‚åˆæœ‰ 2-5 å¹´å·¥ä½œç»éªŒçš„å€™é€‰äºº</div>
</div>
</div>
</div>

<!-- é¢˜ç›®æ•°é‡è®¾ç½® -->
<div class="mb-8">
<h4 class="text-sm font-medium text-gray-900 mb-4">é¢˜ç›®æ•°é‡</h4>
<div class="flex items-center space-x-4">
<button class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center hover:bg-gray-200" id="decreaseCount">
<i class="ri-subtract-line text-gray-600"></i>
</button>
<span class="text-lg font-medium text-gray-900 w-8 text-center" id="questionCount">8</span>
<button class="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center hover:bg-gray-200" id="increaseCount">
<i class="ri-add-line text-gray-600"></i>
</button>
</div>
<div class="text-xs text-gray-500 mt-2">å»ºè®®ç”Ÿæˆ 5-15 ä¸ªé¢˜ç›®</div>
</div>

<!-- é«˜çº§è®¾ç½® -->
<div class="mb-8">
<h4 class="text-sm font-medium text-gray-900 mb-4">é«˜çº§è®¾ç½®</h4>
<div class="space-y-4">
<div class="flex items-center justify-between">
<span class="text-sm text-gray-700">åŒ…å«å‚è€ƒç­”æ¡ˆ</span>
<div class="switch-custom active" id="includeAnswer">
<div class="switch-thumb"></div>
</div>
</div>
<div class="flex items-center justify-between">
<span class="text-sm text-gray-700">æ ‡æ³¨è€ƒå¯Ÿç‚¹</span>
<div class="switch-custom active" id="includePoints">
<div class="switch-thumb"></div>
</div>
</div>
<div class="flex items-center justify-between">
<span class="text-sm text-gray-700">æ™ºèƒ½æ¨è</span>
<div class="switch-custom active" id="smartRecommend">
<div class="switch-thumb"></div>
</div>
</div>
</div>
</div>

<!-- ç”ŸæˆæŒ‰é’® -->
<button class="w-full px-4 py-3 bg-primary text-white rounded-button hover:bg-primary/90 whitespace-nowrap !rounded-button mb-4" id="generateQuestions">
<div class="w-4 h-4 flex items-center justify-center mr-2 inline-block">
<i class="ri-magic-line"></i>
</div>
ç”Ÿæˆé¢˜ç›®
</button>

<!-- æ“ä½œæŒ‰é’® -->
<div class="space-y-3">
<button class="w-full px-4 py-2 text-primary border border-primary rounded-button hover:bg-primary/5 whitespace-nowrap !rounded-button" id="previewQuestions" disabled>
<div class="w-4 h-4 flex items-center justify-center mr-2 inline-block">
<i class="ri-eye-line"></i>
</div>
é¢„è§ˆé¢˜ç›®
</button>
<button class="w-full px-4 py-2 text-gray-600 border border-gray-300 rounded-button hover:bg-gray-50 whitespace-nowrap !rounded-button" id="exportQuestions" disabled>
<div class="w-4 h-4 flex items-center justify-center mr-2 inline-block">
<i class="ri-download-line"></i>
</div>
å¯¼å‡ºé¢˜ç›®
</button>
<button class="w-full px-4 py-2 text-gray-600 border border-gray-300 rounded-button hover:bg-gray-50 whitespace-nowrap !rounded-button" id="startInterview" disabled>
<div class="w-4 h-4 flex items-center justify-center mr-2 inline-block">
<i class="ri-play-line"></i>
</div>
å¼€å§‹é¢è¯•
</button>
</div>

<!-- ç”Ÿæˆç»Ÿè®¡ -->
<div class="mt-8 bg-blue-50 rounded-lg p-4" id="generationStats" style="display: none;">
<div class="flex items-center mb-3">
<div class="w-5 h-5 flex items-center justify-center mr-2">
<i class="ri-information-line text-blue-600"></i>
</div>
<h4 class="text-sm font-medium text-blue-900">ç”Ÿæˆç»Ÿè®¡</h4>
</div>
<div class="text-xs text-blue-700 space-y-1">
<p>â€¢ æŠ€æœ¯åŸºç¡€é¢˜ï¼š<span id="techCount">0</span> ä¸ª</p>
<p>â€¢ é¡¹ç›®ç»éªŒé¢˜ï¼š<span id="projectCount">0</span> ä¸ª</p>
<p>â€¢ ç®—æ³•è®¾è®¡é¢˜ï¼š<span id="algoCount">0</span> ä¸ª</p>
<p>â€¢ ç³»ç»Ÿè®¾è®¡é¢˜ï¼š<span id="systemCount">0</span> ä¸ª</p>
</div>
</div>
</div>
</div>
</div>
</div>

<script id="skill-selection">
document.addEventListener('DOMContentLoaded', function() {
const skillTags = document.querySelectorAll('.skill-tag');
skillTags.forEach(tag => {
tag.addEventListener('click', function() {
this.classList.toggle('selected');
if (this.classList.contains('selected')) {
this.classList.remove('bg-blue-100', 'text-blue-800');
this.classList.add('bg-primary', 'text-white');
} else {
this.classList.remove('bg-primary', 'text-white');
this.classList.add('bg-blue-100', 'text-blue-800');
}
});
});
});
</script>

<script id="project-selection">
document.addEventListener('DOMContentLoaded', function() {
const projectCards = document.querySelectorAll('.project-card');
projectCards.forEach(card => {
const checkbox = card.querySelector('.checkbox-custom');
card.addEventListener('click', function(e) {
if (e.target.type !== 'checkbox') {
checkbox.checked = !checkbox.checked;
}
if (checkbox.checked) {
card.classList.add('border-primary', 'bg-blue-50');
} else {
card.classList.remove('border-primary', 'bg-blue-50');
}
});
});
});
</script>

<script id="difficulty-control">
document.addEventListener('DOMContentLoaded', function() {
const slider = document.getElementById('difficultySlider');
const label = document.getElementById('difficultyLabel');
const desc = document.getElementById('difficultyDesc');
const difficultyData = {
1: { label: 'åˆçº§', desc: 'é€‚åˆåº”å±Šæ¯•ä¸šç”Ÿæˆ– 0-2 å¹´å·¥ä½œç»éªŒ' },
2: { label: 'ä¸­çº§', desc: 'é€‚åˆæœ‰ 2-5 å¹´å·¥ä½œç»éªŒçš„å€™é€‰äºº' },
3: { label: 'é«˜çº§', desc: 'é€‚åˆæœ‰ 5+ å¹´å·¥ä½œç»éªŒçš„èµ„æ·±å€™é€‰äºº' }
};
slider.addEventListener('input', function() {
const value = parseInt(this.value);
const data = difficultyData[value];
label.textContent = data.label;
desc.textContent = data.desc;
});
});
</script>

<script id="question-count-control">
document.addEventListener('DOMContentLoaded', function() {
const countDisplay = document.getElementById('questionCount');
const decreaseBtn = document.getElementById('decreaseCount');
const increaseBtn = document.getElementById('increaseCount');
let count = 8;
decreaseBtn.addEventListener('click', function() {
if (count > 5) {
count--;
countDisplay.textContent = count;
}
});
increaseBtn.addEventListener('click', function() {
if (count < 15) {
count++;
countDisplay.textContent = count;
}
});
});
</script>

<script id="switch-controls">
document.addEventListener('DOMContentLoaded', function() {
const switches = document.querySelectorAll('.switch-custom');
switches.forEach(switchEl => {
switchEl.addEventListener('click', function() {
this.classList.toggle('active');
});
});
});
</script>

<script id="question-generation">
// å…¨å±€å˜é‡å­˜å‚¨ç®€å†è§£æç»“æœ
let resumeData = null;
let selectedSkills = [];
let selectedProjects = [];

document.addEventListener('DOMContentLoaded', function() {
// ä»URLå‚æ•°è·å–ç®€å†è§£æç»“æœ
loadResumeData();
// æ³¨æ„ï¼šrenderResumeData() ç°åœ¨åœ¨æ•°æ®åŠ è½½å®Œæˆåè°ƒç”¨

const generateBtn = document.getElementById('generateQuestions');
const questionsList = document.getElementById('questionsList');
const generationStats = document.getElementById('generationStats');
const previewBtn = document.getElementById('previewQuestions');
const exportBtn = document.getElementById('exportQuestions');
const startBtn = document.getElementById('startInterview');
generateBtn.addEventListener('click', function() {
const button = this;
const originalText = button.innerHTML;
button.innerHTML = '<div class="w-4 h-4 loading-spinner border-2 border-white border-t-transparent rounded-full mr-2 inline-block"></div>ç”Ÿæˆä¸­...';
button.disabled = true;

// è°ƒç”¨åç«¯APIç”Ÿæˆé¢˜ç›®
generateQuestionsWithAI().then(() => {
button.innerHTML = originalText;
button.disabled = false;
previewBtn.disabled = false;
exportBtn.disabled = false;
startBtn.disabled = false;
generationStats.style.display = 'block';
}).catch(error => {
console.error('ç”Ÿæˆé¢˜ç›®å¤±è´¥:', error);
button.innerHTML = originalText;
button.disabled = false;
alert('ç”Ÿæˆé¢˜ç›®å¤±è´¥ï¼Œè¯·é‡è¯•');
});
});
});

// åŠ è½½ç®€å†è§£æç»“æœ
function loadResumeData() {
  const urlParams = new URLSearchParams(window.location.search);
  const taskId = urlParams.get('taskId');
  if (taskId) {
    loadResumeDataFromBackend(taskId);
  } else {
    alert('æœªè·å–åˆ°ç®€å†åˆ†æä»»åŠ¡IDï¼Œè¯·ä»é¦–é¡µé‡æ–°ä¸Šä¼ ç®€å†ï¼');
    window.location.href = './setting_page1.html';
  }
}

// ä»åç«¯åŠ è½½ç®€å†æ•°æ®
async function loadResumeDataFromBackend(taskId) {
try {
console.log('ğŸ”„ æ­£åœ¨ä»åç«¯åŠ è½½ç®€å†æ•°æ®...');
const response = await fetch(`/api/v1/resume/json/${taskId}`);
const result = await response.json();
if (result.success && result.data) {
resumeData = result.data;
console.log('âœ… ä»åç«¯åŠ è½½ç®€å†æ•°æ®æˆåŠŸ:', resumeData);
// ğŸ†• æ•°æ®åŠ è½½æˆåŠŸåç«‹å³æ¸²æŸ“
renderResumeData();
} else {
console.error('âŒ ä»åç«¯åŠ è½½æ•°æ®å¤±è´¥:', result.message);
resumeData = getDefaultResumeData();
// ğŸ†• ä½¿ç”¨é»˜è®¤æ•°æ®åä¹Ÿéœ€è¦æ¸²æŸ“
renderResumeData();
}
} catch (error) {
console.error('âŒ åŠ è½½ç®€å†æ•°æ®å¼‚å¸¸:', error);
resumeData = getDefaultResumeData();
// ğŸ†• å¼‚å¸¸æƒ…å†µä¸‹ä¹Ÿéœ€è¦æ¸²æŸ“é»˜è®¤æ•°æ®
renderResumeData();
}
}

// è·å–é»˜è®¤ç®€å†æ•°æ®
function getDefaultResumeData() {
return {
basic_info: {
name: 'è«æ ©',
phone: '13480805647',
email: '2022302181277@whu.edu.cn',
city: 'æ­¦æ±‰å¸‚',
current_position: 'ç®—æ³•å·¥ç¨‹å¸ˆ',
experience_years: '2'
},
skills: ['Python', 'PyTorch', 'Springboot', 'React', 'Docker', 'FastAPI', 'Redis', 'MongoDB'],
skills_categories: {
programming_languages: ['Python', 'JavaScript', 'Java'],
frameworks: ['PyTorch', 'Springboot', 'React', 'FastAPI'],
databases: ['Redis', 'MongoDB', 'MySQL'],
tools: ['Docker', 'Git', 'Linux']
},
projects: [
{
name: 'å¤§æ¨¡å‹å¾®è°ƒçš„å®‰å…¨å¯¹é½ç ”ç©¶',
description: 'æˆåŠŸå¤ç°ICLRçš„å…³é”®ç»“è®ºï¼Œé‡‡ç”¨GPT-4oå¯¹ç›®æ ‡å¤§è¯­è¨€æ¨¡å‹è¾“å‡ºè¿›è¡Œç²¾ç»†åŒ–å®‰å…¨æ€§é‡åŒ–è¯„ä¼°',
tech_stack: 'Python, PyTorch, GPT-4o, å®‰å…¨è¯„ä¼°',
period: '2025.03 - è‡³ä»Š'
},
{
name: 'èˆ†æƒ…åˆ†æç³»ç»Ÿ',
description: 'å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œæ”¯æŒå®æ—¶æƒ…æ„Ÿåˆ†æå’Œçƒ­ç‚¹äº‹ä»¶æ£€æµ‹',
tech_stack: 'React, FastAPI, Redis, MongoDB, Docker',
period: '2024.11 - è‡³ä»Š'
},
{
name: 'ç”µå•†ç”µç¾¤è¿è¥',
description: 'ä»é›¶å¼€å§‹å­µåŒ–å¹¶è¿è¥ä¸ƒä¸ªåº—é“ºï¼Œå½¢æˆåº—ç¾¤æ•ˆåº”ï¼ŒCç«¯è¥æ”¶çªç ´ç™¾ä¸‡',
tech_stack: 'å›¢é˜Ÿç®¡ç†, è‡ªåŠ¨åŒ–ç³»ç»Ÿ, æ•°æ®åˆ†æ',
period: '2023.06 - è‡³ä»Š'
}
],
experience: [
{
company: 'æ­¦æ±‰å¤§å­¦',
position: 'å­¦ç”Ÿ',
period: '2022.09 - 2026.06',
responsibilities: [
'å¤§æ¨¡å‹å¾®è°ƒçš„å®‰å…¨å¯¹é½ç ”ç©¶',
'èˆ†æƒ…åˆ†æç³»ç»Ÿå¼€å‘',
'åˆ›æ–°å‘æ˜ä¸çŸ¥è¯†äº§æƒåä¼šå‰¯ä¼šé•¿'
]
},
{
company: 'ç”µå•†ç”µç¾¤',
position: 'åˆ›ä¸šè€…',
period: '2023.06 - è‡³ä»Š',
responsibilities: [
'å›¢é˜Ÿç®¡ç†ï¼šç»„å»º9äººè·¨èŒèƒ½å›¢é˜Ÿ',
'æ•ˆç‡ä¼˜åŒ–ï¼šå¼•å…¥æ™ºèƒ½å‘è´§æœºå™¨äºº',
'è§„æ¨¡æ‹“å±•ï¼šè¿è¥ä¸ƒä¸ªåº—é“ºï¼ŒæœåŠ¡è¶…äºŒåä¸‡ç”¨æˆ·'
]
}
],
analysis: {
overall_match: 86
}
};
}

// æ¸²æŸ“ç®€å†æ•°æ®åˆ°ç•Œé¢
function renderResumeData() {
if (!resumeData) return;

// æ¸²æŸ“æŠ€èƒ½ç‚¹
renderSkills();
// æ¸²æŸ“é¡¹ç›®ç»éªŒ
renderProjects();
}

// æ¸²æŸ“æŠ€èƒ½ç‚¹
function renderSkills() {
const skillsContainer = document.getElementById('skillsContainer');
if (!skillsContainer || !resumeData.skills) return;

skillsContainer.innerHTML = '';
resumeData.skills.forEach(skill => {
const skillTag = document.createElement('span');
skillTag.className = 'skill-tag px-3 py-2 bg-blue-100 text-blue-800 text-sm rounded-lg';
skillTag.textContent = skill;
skillTag.addEventListener('click', function() {
this.classList.toggle('selected');
if (this.classList.contains('selected')) {
this.classList.remove('bg-blue-100', 'text-blue-800');
this.classList.add('bg-primary', 'text-white');
selectedSkills.push(skill);
} else {
this.classList.remove('bg-primary', 'text-white');
this.classList.add('bg-blue-100', 'text-blue-800');
selectedSkills = selectedSkills.filter(s => s !== skill);
}
});
skillsContainer.appendChild(skillTag);
});
}

// æ¸²æŸ“é¡¹ç›®ç»éªŒ
function renderProjects() {
const projectsContainer = document.getElementById('projectsContainer');
if (!projectsContainer || !resumeData.projects) return;

// æ¸…ç©ºç°æœ‰é¡¹ç›®å¡ç‰‡
projectsContainer.innerHTML = '';

// æ·»åŠ çœŸå®é¡¹ç›®æ•°æ®
resumeData.projects.forEach(project => {
const projectDiv = document.createElement('div');
projectDiv.className = 'border border-gray-200 rounded-lg p-4 hover:border-primary transition-colors cursor-pointer project-card';
projectDiv.innerHTML = `
<div class="flex items-start justify-between mb-2">
<h4 class="text-base font-medium text-gray-900">${project.name}</h4>
<input type="checkbox" class="checkbox-custom">
</div>
<p class="text-gray-600 text-sm mb-3">${project.description}</p>
<div class="flex flex-wrap gap-2 mb-3">
${project.tech_stack.split(', ').map(tech => 
`<span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded">${tech}</span>`
).join('')}
</div>
<div class="flex items-center text-xs text-gray-500">
<i class="ri-time-line mr-1"></i>
${project.period}
</div>
`;

// æ·»åŠ é¡¹ç›®é€‰æ‹©äº‹ä»¶
const checkbox = projectDiv.querySelector('.checkbox-custom');
projectDiv.addEventListener('click', function(e) {
if (e.target.type !== 'checkbox') {
checkbox.checked = !checkbox.checked;
}
if (checkbox.checked) {
projectDiv.classList.add('border-primary', 'bg-blue-50');
selectedProjects.push(project);
} else {
projectDiv.classList.remove('border-primary', 'bg-blue-50');
selectedProjects = selectedProjects.filter(p => p.name !== project.name);
}
});

projectsContainer.appendChild(projectDiv);
});
}

// AIç”Ÿæˆé¢˜ç›®å‡½æ•°
async function generateQuestionsWithAI() {
const techBasic = document.getElementById('techBasic').checked;
const projectExp = document.getElementById('projectExp').checked;
const algorithm = document.getElementById('algorithm').checked;
const systemDesign = document.getElementById('systemDesign').checked;
const count = parseInt(document.getElementById('questionCount').textContent);
const difficulty = parseInt(document.getElementById('difficultySlider').value);
const includeAnswer = document.getElementById('includeAnswer').classList.contains('active');
const includePoints = document.getElementById('includePoints').classList.contains('active');

// æ„å»ºè¯·æ±‚å‚æ•°
const requestData = {
resume_data: resumeData,
selected_skills: selectedSkills,
selected_projects: selectedProjects,
question_types: {
tech_basic: techBasic,
project_experience: projectExp,
algorithm_design: algorithm,
system_design: systemDesign
},
question_count: count,
difficulty_level: difficulty,
include_answer: includeAnswer,
include_points: includePoints
};

try {
console.log('ğŸš€ å¼€å§‹AIç”Ÿæˆé¢˜ç›®...');
console.log('ğŸ“‹ è¯·æ±‚å‚æ•°:', requestData);

const response = await fetch('/api/v1/questions/generate', {
method: 'POST',
headers: {
'Content-Type': 'application/json'
},
body: JSON.stringify(requestData)
});

const result = await response.json();

if (result.success) {
console.log('âœ… AIç”Ÿæˆé¢˜ç›®æˆåŠŸ:', result.questions);
renderQuestions(result.questions, includeAnswer, includePoints);
updateGenerationStats(result.questions);
} else {
console.error('âŒ AIç”Ÿæˆé¢˜ç›®å¤±è´¥:', result.message);
throw new Error(result.message);
}
} catch (error) {
console.error('âŒ AIç”Ÿæˆé¢˜ç›®å¼‚å¸¸:', error);
throw error;
}
}

// æ›´æ–°ç”Ÿæˆç»Ÿè®¡
function updateGenerationStats(questions) {
let techCount = 0, projectCount = 0, algoCount = 0, systemCount = 0;
questions.forEach(q => {
if (q.type === 'tech_basic') techCount++;
else if (q.type === 'project_experience') projectCount++;
else if (q.type === 'algorithm_design') algoCount++;
else if (q.type === 'system_design') systemCount++;
});

document.getElementById('techCount').textContent = techCount;
document.getElementById('projectCount').textContent = projectCount;
document.getElementById('algoCount').textContent = algoCount;
document.getElementById('systemCount').textContent = systemCount;
}

// ä¿ç•™åŸæœ‰çš„generateQuestionså‡½æ•°ä½œä¸ºå¤‡ç”¨
function generateQuestions() {
const techBasic = document.getElementById('techBasic').checked;
const projectExp = document.getElementById('projectExp').checked;
const algorithm = document.getElementById('algorithm').checked;
const systemDesign = document.getElementById('systemDesign').checked;
const count = parseInt(document.getElementById('questionCount').textContent);
const includeAnswer = document.getElementById('includeAnswer').classList.contains('active');
const includePoints = document.getElementById('includePoints').classList.contains('active');
let questions = [];
let techCount = 0, projectCount = 0, algoCount = 0, systemCount = 0;
const types = [];
if (techBasic) types.push('techBasic');
if (projectExp) types.push('projectExp');
if (algorithm) types.push('algorithm');
if (systemDesign) types.push('systemDesign');
for (let i = 0; i < count; i++) {
const type = types[i % types.length];
const templates = questionTemplates[type];
const template = templates[Math.floor(Math.random() * templates.length)];
questions.push({
type: type,
...template
});
if (type === 'techBasic') techCount++;
else if (type === 'projectExp') projectCount++;
else if (type === 'algorithm') algoCount++;
else if (type === 'systemDesign') systemCount++;
}
document.getElementById('techCount').textContent = techCount;
document.getElementById('projectCount').textContent = projectCount;
document.getElementById('algoCount').textContent = algoCount;
document.getElementById('systemCount').textContent = systemCount;
renderQuestions(questions, includeAnswer, includePoints);
}
function renderQuestions(questions, includeAnswer, includePoints) {
const typeLabels = {
tech_basic: 'æŠ€æœ¯åŸºç¡€',
project_experience: 'é¡¹ç›®ç»éªŒ',
algorithm_design: 'ç®—æ³•è®¾è®¡',
system_design: 'ç³»ç»Ÿè®¾è®¡',
techBasic: 'æŠ€æœ¯åŸºç¡€',
projectExp: 'é¡¹ç›®ç»éªŒ',
algorithm: 'ç®—æ³•è®¾è®¡',
systemDesign: 'ç³»ç»Ÿè®¾è®¡'
};
const typeColors = {
tech_basic: 'bg-blue-100 text-blue-800',
project_experience: 'bg-green-100 text-green-800',
algorithm_design: 'bg-purple-100 text-purple-800',
system_design: 'bg-orange-100 text-orange-800',
techBasic: 'bg-blue-100 text-blue-800',
projectExp: 'bg-green-100 text-green-800',
algorithm: 'bg-purple-100 text-purple-800',
systemDesign: 'bg-orange-100 text-orange-800'
};
questionsList.innerHTML = questions.map((q, index) => `
<div class="bg-white rounded-xl shadow-sm border border-gray-200 p-6 question-card fade-in">
<div class="flex items-start justify-between mb-4">
<div class="flex items-center space-x-3">
<span class="text-lg font-medium text-gray-900">é¢˜ç›® ${index + 1}</span>
<span class="px-2 py-1 ${typeColors[q.type]} text-xs rounded-full">${typeLabels[q.type]}</span>
</div>
<div class="flex items-center space-x-2">
<button class="p-2 text-gray-400 hover:text-gray-600" onclick="toggleFavorite(this)">
<div class="w-5 h-5 flex items-center justify-center">
<i class="ri-heart-line"></i>
</div>
</button>
<button class="p-2 text-gray-400 hover:text-gray-600">
<div class="w-5 h-5 flex items-center justify-center">
<i class="ri-more-line"></i>
</div>
</button>
</div>
</div>
<div class="mb-4">
<h4 class="text-base font-medium text-gray-900 mb-2">é¢˜ç›®å†…å®¹</h4>
<p class="text-gray-700 leading-relaxed">${q.title}</p>
</div>
${includePoints ? `
<div class="mb-4">
<h4 class="text-sm font-medium text-gray-900 mb-2">è€ƒå¯Ÿç‚¹</h4>
<div class="flex flex-wrap gap-2">
${q.points.map(point => `<span class="px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded">${point}</span>`).join('')}
</div>
</div>
` : ''}
${includeAnswer ? `
<div class="border-t border-gray-200 pt-4">
<button class="flex items-center text-sm font-medium text-primary hover:text-primary/80 mb-3" onclick="toggleAnswer(this)">
<div class="w-4 h-4 flex items-center justify-center mr-1">
<i class="ri-eye-line"></i>
</div>
æŸ¥çœ‹å‚è€ƒç­”æ¡ˆ
<div class="w-4 h-4 flex items-center justify-center ml-1">
<i class="ri-arrow-down-s-line"></i>
</div>
</button>
<div class="answer-content hidden bg-gray-50 rounded-lg p-4">
<p class="text-gray-700 text-sm leading-relaxed">${q.answer}</p>
</div>
</div>
` : ''}
</div>
`).join('');
}
window.toggleAnswer = function(button) {
const content = button.nextElementSibling;
const icon = button.querySelector('i:last-child');
if (content.classList.contains('hidden')) {
content.classList.remove('hidden');
icon.className = 'ri-arrow-up-s-line';
button.innerHTML = button.innerHTML.replace('æŸ¥çœ‹å‚è€ƒç­”æ¡ˆ', 'éšè—å‚è€ƒç­”æ¡ˆ');
} else {
content.classList.add('hidden');
icon.className = 'ri-arrow-down-s-line';
button.innerHTML = button.innerHTML.replace('éšè—å‚è€ƒç­”æ¡ˆ', 'æŸ¥çœ‹å‚è€ƒç­”æ¡ˆ');
}
};
window.toggleFavorite = function(button) {
const icon = button.querySelector('i');
if (icon.classList.contains('ri-heart-line')) {
icon.className = 'ri-heart-fill';
button.classList.add('text-red-500');
} else {
icon.className = 'ri-heart-line';
button.classList.remove('text-red-500');
}
};
</script>

<script id="export-and-preview">
document.addEventListener('DOMContentLoaded', function() {
const previewBtn = document.getElementById('previewQuestions');
const exportBtn = document.getElementById('exportQuestions');
const startBtn = document.getElementById('startInterview');
previewBtn.addEventListener('click', function() {
const dialog = document.createElement('div');
dialog.className = 'fixed inset-0 flex items-center justify-center z-50';
dialog.innerHTML = `
<div class="fixed inset-0 bg-black/50" onclick="this.parentElement.remove()"></div>
<div class="relative bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[80vh] overflow-y-auto">
<div class="flex items-center justify-between mb-4">
<h3 class="text-lg font-medium text-gray-900">é¢˜ç›®é¢„è§ˆ</h3>
<button class="p-2 text-gray-400 hover:text-gray-600" onclick="this.closest('.fixed').remove()">
<i class="ri-close-line"></i>
</button>
</div>
<div class="space-y-4">
<div class="text-sm text-gray-600">å…±ç”Ÿæˆ ${document.getElementById('questionCount').textContent} é“é¢˜ç›®</div>
<div class="bg-blue-50 rounded-lg p-4">
<p class="text-sm text-blue-700">é¢„è§ˆæ¨¡å¼ä¸‹ä»…æ˜¾ç¤ºé¢˜ç›®æ¦‚è§ˆï¼Œå®Œæ•´å†…å®¹è¯·åœ¨ä¸»ç•Œé¢æŸ¥çœ‹ã€‚</p>
</div>
</div>
</div>
`;
document.body.appendChild(dialog);
});
exportBtn.addEventListener('click', function() {
const dialog = document.createElement('div');
dialog.className = 'fixed inset-0 flex items-center justify-center z-50';
dialog.innerHTML = `
<div class="fixed inset-0 bg-black/50"></div>
<div class="relative bg-white rounded-lg p-6 max-w-sm w-full mx-4">
<h3 class="text-lg font-medium text-gray-900 mb-2">å¯¼å‡ºæˆåŠŸ</h3>
<p class="text-gray-600 mb-4">é¢˜ç›®å·²å¯¼å‡ºä¸º PDF æ–‡ä»¶åˆ°ä¸‹è½½æ–‡ä»¶å¤¹</p>
<button class="w-full px-4 py-2 bg-primary text-white rounded-button" onclick="this.closest('.fixed').remove()">ç¡®å®š</button>
</div>
`;
document.body.appendChild(dialog);
});
startBtn.addEventListener('click', function() {
const dialog = document.createElement('div');
dialog.className = 'fixed inset-0 flex items-center justify-center z-50';
dialog.innerHTML = `
<div class="fixed inset-0 bg-black/50"></div>
<div class="relative bg-white rounded-lg p-6 max-w-sm w-full mx-4">
<h3 class="text-lg font-medium text-gray-900 mb-2">å¼€å§‹é¢è¯•</h3>
<p class="text-gray-600 mb-4">å³å°†è¿›å…¥é¢è¯•æ¨¡æ‹Ÿç¯èŠ‚ï¼Œè¯·ç¡®ä¿è®¾å¤‡æ­£å¸¸å·¥ä½œ</p>
<div class="flex space-x-3">
<button class="flex-1 px-4 py-2 text-gray-600 border border-gray-300 rounded-button hover:bg-gray-50" onclick="this.closest('.fixed').remove()">å–æ¶ˆ</button>
<button class="flex-1 px-4 py-2 bg-primary text-white rounded-button hover:bg-primary/90" onclick="this.closest('.fixed').remove()">å¼€å§‹</button>
</div>
</div>
`;
document.body.appendChild(dialog);
});
});
</script>
<script>
document.addEventListener('DOMContentLoaded', function() {
  const startBtn = document.getElementById('startInterview');
  if (startBtn) {
    startBtn.addEventListener('click', async function() {
      if (!startBtn.disabled) {
        try {
          // ç¦ç”¨æŒ‰é’®ï¼Œæ˜¾ç¤ºåŠ è½½çŠ¶æ€
          startBtn.disabled = true;
          startBtn.innerHTML = '<i class="ri-loader-4-line animate-spin mr-2"></i>æ­£åœ¨å‡†å¤‡é¢è¯•...';
          
          // è·å–å½“å‰é¡µé¢çš„taskId
          const urlParams = new URLSearchParams(window.location.search);
          const taskId = urlParams.get('taskId');
          
          // æ”¶é›†é¢˜ç›®ç”Ÿæˆå‚æ•°
          const generateData = {
            task_id: taskId || '',
            resume_data: resumeData || getDefaultResumeData(),
            selected_skills: selectedSkills,
            selected_projects: selectedProjects,
            question_types: {
              tech_basic: document.getElementById('techBasic').checked,
              project_experience: document.getElementById('projectExp').checked,
              algorithm_design: document.getElementById('algorithm').checked,
              system_design: document.getElementById('systemDesign').checked
            },
            question_count: parseInt(document.getElementById('questionCount').textContent),
            difficulty_level: parseInt(document.getElementById('difficultySlider').value),
            include_answer: document.getElementById('includeAnswer').classList.contains('active'),
            include_points: document.getElementById('includePoints').classList.contains('active')
          };
          
          console.log('ğŸš€ å¼€å§‹ç”Ÿæˆé¢è¯•é¢˜ç›®...', generateData);
          
          // è°ƒç”¨åç«¯APIç”Ÿæˆé¢˜ç›®å¹¶å­˜å‚¨åˆ°Redis
          const response = await fetch('/api/v1/questions/generate', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(generateData)
          });
          
          const result = await response.json();
          
          if (result.success && result.stats && result.stats.session_id) {
            console.log('âœ… é¢˜ç›®ç”ŸæˆæˆåŠŸï¼Œsession_id:', result.stats.session_id);
            
            // å°†session_idä¿å­˜åˆ°localStorage
            localStorage.setItem('interview_session_id', result.stats.session_id);
            
            // è·³è½¬åˆ°é¢è¯•é¡µé¢
            window.location.href = `./interview-simulation.html?session_id=${result.stats.session_id}`;
          } else {
            throw new Error(result.message || 'é¢˜ç›®ç”Ÿæˆå¤±è´¥');
          }
          
        } catch (error) {
          console.error('âŒ å‡†å¤‡é¢è¯•å¤±è´¥:', error);
          alert('å‡†å¤‡é¢è¯•å¤±è´¥ï¼Œè¯·é‡è¯•ï¼š' + error.message);
          
          // æ¢å¤æŒ‰é’®çŠ¶æ€
          startBtn.disabled = false;
          startBtn.innerHTML = '<div class="w-4 h-4 flex items-center justify-center mr-2 inline-block"><i class="ri-play-line"></i></div>å¼€å§‹é¢è¯•';
        }
      }
    });
  }
});
</script>
    <!-- å¯¼å…¥å¯¼èˆªæ ç»„ä»¶ -->
    <script src="./components/navbar.js"></script>
</body>
</html>