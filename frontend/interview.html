<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI é¢è¯•å®˜ - æ²‰æµ¸å¼é¢è¯•æ¨¡æ‹Ÿå¹³å°</title>
<script src="https://cdn.tailwindcss.com/3.4.16"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.5.0/echarts.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
tailwind.config = {
theme: {
extend: {
colors: {
primary: '#3B82F6',
secondary: '#E0F2FE'
},
borderRadius: {
'none': '0px',
'sm': '4px',
DEFAULT: '8px',
'md': '12px',
'lg': '16px',
'xl': '20px',
'2xl': '24px',
'3xl': '32px',
'full': '9999px',
'button': '8px'
}
}
}
}
</script>
<style>
:where([class^="ri-"])::before {
content: "\f3c2";
}
@keyframes breathe {
0%, 100% { transform: scale(1); opacity: 1; }
50% { transform: scale(1.05); opacity: 0.8; }
}
.breathing {
animation: breathe 3s ease-in-out infinite;
}
.code-editor {
font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
background: #1e1e1e;
color: #d4d4d4;
}
::-webkit-scrollbar {
width: 14px;
height: 14px;
}
::-webkit-scrollbar-track {
background: #1e1e1e;
}
::-webkit-scrollbar-thumb {
background: #424242;
border: 3px solid #1e1e1e;
border-radius: 7px;
}
::-webkit-scrollbar-thumb:hover {
background: #4f4f4f;
}
::selection {
background: #264f78;
}
.video-container {
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
}
.glass-effect {
background: rgba(255, 255, 255, 0.95);
backdrop-filter: blur(10px);
}
.progress-line {
background: linear-gradient(90deg, #3B82F6 0%, #E5E7EB 0%);
transition: background 0.5s ease;
}
.active-step .progress-line {
background: linear-gradient(90deg, #3B82F6 60%, #E5E7EB 60%);
}
.mic-pulse {
box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7);
animation: pulse 2s infinite;
}
@keyframes pulse {
0% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0.7); }
70% { box-shadow: 0 0 0 10px rgba(59, 130, 246, 0); }
100% { box-shadow: 0 0 0 0 rgba(59, 130, 246, 0); }
}
.subtitle-overlay {
background: linear-gradient(180deg, transparent 0%, rgba(0,0,0,0.8) 100%);
}
.fullscreen-mode {
position: fixed !important;
top: 0 !important;
left: 0 !important;
width: 100vw !important;
height: 100vh !important;
z-index: 9999 !important;
border-radius: 0 !important;
}
#expandPanelButton button:hover {
transform: translateX(-3px);
}
#rightEdgeHover {
/* è°ƒè¯•æ—¶å¯ä»¥æ˜¾ç¤ºhoveråŒºåŸŸï¼šbackground: rgba(255,0,0,0.1); */
background: transparent;
cursor: pointer;
}
#expandPanelButton {
pointer-events: all;
}
</style>
</head>
<body class="bg-gray-50 min-h-screen">
<!-- å¯¼èˆªæ å®¹å™¨ - ç»„ä»¶ä¼šè‡ªåŠ¨æ’å…¥åˆ°è¿™é‡Œ -->
<div id="navbar-container"></div>
<!-- é¡¶éƒ¨è¿›åº¦å¯¼èˆª -->
<div class="bg-white border-b border-gray-100 px-6 py-4">
    <div class="max-w-7xl mx-auto">
      <div class="flex items-center justify-center space-x-8">
        <div class="flex items-center space-x-2">
          <div
            class="w-8 h-8 bg-primary rounded-full flex items-center justify-center breathing"
          >
            <i class="ri-check-line text-white text-sm"></i>
          </div>
          <span class="text-sm font-medium text-gray-900">ç®€å†è§£æ</span>
        </div>
        <div class="w-16 h-0.5 progress-line"></div>
        <div class="flex items-center space-x-2 active-step">
          <div
            class="w-8 h-8 bg-primary rounded-full flex items-center justify-center breathing"
          >
            <div class="w-2 h-2 bg-white rounded-full"></div>
          </div>
          <span class="text-sm font-medium text-primary">è¡Œä¸ºé¢è¯•</span>
        </div>
        <div class="w-16 h-0.5 bg-gray-200"></div>
        <div class="flex items-center space-x-2">
          <div
            class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center"
          >
            <div class="w-2 h-2 bg-gray-400 rounded-full"></div>
          </div>
          <span class="text-sm text-gray-500">ä¸“ä¸šæ·±æŒ–</span>
        </div>
        <div class="w-16 h-0.5 bg-gray-200"></div>
        <div class="flex items-center space-x-2">
          <div
            class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center"
          >
            <div class="w-2 h-2 bg-gray-400 rounded-full"></div>
          </div>
          <span class="text-sm text-gray-500">åå‘æé—®</span>
        </div>
        <div class="w-16 h-0.5 bg-gray-200"></div>
        <div class="flex items-center space-x-2">
          <div
            class="w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center"
          >
            <div class="w-2 h-2 bg-gray-400 rounded-full"></div>
          </div>
          <span class="text-sm text-gray-500">å¤ç›˜æ€»ç»“</span>
        </div>
      </div>
    </div>
  </div>
<!-- ä¸»ä½“å†…å®¹ -->
<div class="flex h-screen">
<!-- å·¦ä¾§ä¼šè¯å†å² -->
<div class="w-80 bg-gray-50 border-r border-gray-100 flex flex-col">
<div class="p-4 border-b border-gray-100 space-y-3">
<button id="new-interview-btn" class="w-full py-2 bg-primary text-white rounded-lg hover:bg-blue-600 transition-colors flex items-center justify-center space-x-2 !rounded-button">
<i class="ri-add-line"></i>
<span>æ–°å»ºé¢è¯•</span>
</button>
<div class="relative">
<input type="text" id="session-search-input" placeholder="æœç´¢é¢è¯•è®°å½•..." class="w-full pl-10 pr-4 py-2 bg-white border border-gray-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
<div class="absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 flex items-center justify-center">
<i class="ri-search-line text-gray-400 text-sm"></i>
</div>
</div>
</div>
<div class="flex-1 overflow-y-auto p-4 space-y-3" id="sessions-list-container">
<!-- ä¼šè¯åˆ—è¡¨å°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
<div class="flex flex-col items-center justify-center py-8 text-center">
<div class="w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mb-3">
<i class="ri-chat-3-line text-gray-400 text-xl"></i>
</div>
<p class="text-sm text-gray-500 mb-1">æš‚æ— é¢è¯•è®°å½•</p>
<p class="text-xs text-gray-400">ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®å¼€å§‹æ–°é¢è¯•</p>
</div>
</div>
</div>
<!-- ä¸­å¤®ä¸»èˆå° -->
<div class="flex-1 flex flex-col relative">
<!-- æ¨¡å¼åˆ‡æ¢æŒ‰é’® -->
<div class="absolute top-4 right-4 z-10 flex items-center space-x-2">
<button id="camera-toggle" class="bg-white/90 backdrop-blur-sm px-3 py-2 rounded-lg shadow-lg flex items-center space-x-2 hover:bg-white transition-colors !rounded-button">
<i class="ri-camera-line text-gray-700"></i>
<span class="text-xs text-gray-700">æ‘„åƒå¤´</span>
</button>
<button id="mode-switch" class="bg-white/90 backdrop-blur-sm px-4 py-2 rounded-lg shadow-lg flex items-center space-x-2 hover:bg-white transition-colors !rounded-button">
<i class="ri-code-line text-gray-700"></i>
<span class="text-sm text-gray-700 whitespace-nowrap">ä»£ç æ¨¡å¼</span>
</button>
</div>

<!-- ä¸»å†…å®¹åŒºåŸŸ -->
<div class="flex-1 relative bg-gradient-to-br from-slate-900 to-slate-800">
<!-- ä¸»ä½ç½®åŒºåŸŸ -->
<div id="main-stage" class="absolute inset-4 rounded-xl overflow-hidden">
<!-- AI æ•°å­—äººè§†é¢‘ (é»˜è®¤ä¸»ä½ç½®) -->
<div id="ai-video-main" class="w-full h-full relative video-container">
<img src="https://readdy.ai/api/search-image?query=professional%20female%20AI%20interviewer%20with%20natural%20expressions%2C%20modern%20office%20background%2C%20clean%20lighting%2C%20realistic%20digital%20human%2C%20friendly%20and%20confident%20demeanor%2C%20business%20attire%2C%20eye%20contact%20with%20camera&width=800&height=600&seq=ai-interviewer-main&orientation=landscape"
alt="AIé¢è¯•å®˜" class="w-full h-full object-cover object-top">
<!-- å®æ—¶å­—å¹•åŒºåŸŸ -->
<div class="absolute bottom-0 left-0 right-0 subtitle-overlay p-6">
<div class="bg-black bg-opacity-60 rounded-lg p-3">
<div class="flex items-start space-x-3">
<div class="w-8 h-8 bg-primary rounded-full flex items-center justify-center flex-shrink-0">
<i class="ri-robot-line text-white text-sm"></i>
</div>
<div class="flex-1">
<p class="text-xs text-gray-300 mb-1">AIé¢è¯•å®˜ - æ˜Ÿç«æ™ºèƒ½ä½“</p>
<p id="ai-subtitle-text" class="text-white text-sm leading-relaxed">ç­‰å¾…è¯­éŸ³è¾“å…¥æˆ–æ–‡å­—æ¶ˆæ¯...</p>
</div>
</div>
</div>
</div>
</div>

<!-- ç”¨æˆ·æ‘„åƒå¤´è§†é¢‘ (å¯åˆ‡æ¢åˆ°ä¸»ä½ç½®) -->
<div id="user-video-main" class="w-full h-full relative bg-gray-800 hidden">
<video id="user-video" class="w-full h-full object-cover" autoplay muted></video>
<div class="absolute bottom-0 left-0 right-0 subtitle-overlay p-6">
<div class="bg-black bg-opacity-60 rounded-lg p-3">
<div class="flex items-start space-x-3">
<div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0">
<i class="ri-user-line text-white text-sm"></i>
</div>
                        <div class="flex-1">
                            <p class="text-xs text-gray-300 mb-1">é¢è¯•è€…</p>
                            <p id="user-subtitle-text" class="text-white text-sm leading-relaxed">å‡†å¤‡å°±ç»ªï¼Œç­‰å¾…å‘è¨€...</p>
                        </div>
</div>
</div>
</div>
</div>

<!-- ä»£ç ç¼–è¾‘å™¨ (ä»£ç æ¨¡å¼ä¸»ä½ç½®) -->
<div id="code-editor-main" class="w-full h-full bg-[#1e1e1e] rounded-lg overflow-hidden flex flex-col hidden">
<!-- é¡¶éƒ¨å·¥å…·æ  -->
<div class="bg-[#252526] border-b border-[#3e3e42] px-4 py-2 flex items-center justify-between">
<div class="flex items-center space-x-4">
<div class="flex items-center space-x-2">
<div class="w-3 h-3 bg-red-500 rounded-full"></div>
<div class="w-3 h-3 bg-yellow-500 rounded-full"></div>
<div class="w-3 h-3 bg-green-500 rounded-full"></div>
</div>
<div class="flex items-center space-x-3 border-l border-[#3e3e42] pl-4">
<label class="text-xs text-gray-300">è¯­è¨€:</label>
<select id="language-select" class="bg-[#3e3e42] text-gray-300 text-xs px-3 py-1 rounded border-none focus:outline-none focus:ring-1 focus:ring-blue-500">
<option value="javascript">JavaScript</option>
<option value="typescript">TypeScript</option>
<option value="python">Python</option>
<option value="java">Java</option>
<option value="cpp">C++</option>
<option value="csharp">C#</option>
<option value="go">Go</option>
<option value="rust">Rust</option>
<option value="php">PHP</option>
<option value="sql">SQL</option>
<option value="html">HTML</option>
<option value="css">CSS</option>
</select>
</div>
</div>
<div class="flex items-center space-x-3">
<button id="reset-code" class="w-8 h-8 flex items-center justify-center text-gray-400 hover:text-white transition-colors" title="é‡ç½®ä»£ç ">
<i class="ri-refresh-line"></i>
</button>
<button id="format-code" class="w-8 h-8 flex items-center justify-center text-gray-400 hover:text-white transition-colors" title="æ ¼å¼åŒ–ä»£ç ">
<i class="ri-code-line"></i>
</button>
<button id="editor-settings" class="w-8 h-8 flex items-center justify-center text-gray-400 hover:text-white transition-colors" title="ç¼–è¾‘å™¨è®¾ç½®">
<i class="ri-settings-3-line"></i>
</button>
<button id="fullscreen-editor" class="w-8 h-8 flex items-center justify-center text-gray-400 hover:text-white transition-colors" title="å…¨å±ç¼–è¾‘å™¨">
<i class="ri-fullscreen-line"></i>
</button>
</div>
</div>
<!-- Monaco ç¼–è¾‘å™¨å®¹å™¨ -->
<div id="monaco-editor" class="flex-1"></div>
<!-- åº•éƒ¨çŠ¶æ€æ  -->
<div class="bg-[#007acc] text-white text-xs px-4 py-1 flex items-center justify-between">
<div class="flex items-center space-x-4">
<span id="current-language">JavaScript</span>
<span>UTF-8</span>
<span id="cursor-position">è¡Œ 1, åˆ— 1</span>
</div>
<div class="flex items-center space-x-4">
<span id="character-count">å­—ç¬¦: 0</span>
<span id="line-count">è¡Œæ•°: 1</span>
<span class="text-gray-300">Web IDE v1.0</span>
</div>
</div>
</div>
</div>

<!-- æ¬¡ä½ç½®åŒºåŸŸ (å³ä¸Šè§’å°çª—) -->
<div id="secondary-stage" class="absolute top-6 right-6 w-80 h-60 rounded-lg overflow-hidden shadow-xl transition-all duration-300 hidden">
<!-- AI æ•°å­—äººå°çª— -->
<div id="ai-video-secondary" class="w-full h-full relative video-container hidden">
<img src="https://readdy.ai/api/search-image?query=professional%20female%20AI%20interviewer%20with%20natural%20expressions%2C%20modern%20office%20background%2C%20clean%20lighting%2C%20realistic%20digital%20human%2C%20friendly%20and%20confident%20demeanor%2C%20business%20attire%2C%20eye%20contact%20with%20camera&width=400&height=300&seq=ai-interviewer-secondary&orientation=landscape"
alt="AIé¢è¯•å®˜" class="w-full h-full object-cover object-top">
<!-- å°çª—å­—å¹• -->
<div class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-70 p-2">
<p class="text-white text-xs leading-relaxed" id="ai-subtitle-secondary">AIé¢è¯•å®˜</p>
</div>
<!-- å°çª—æ§åˆ¶ -->
<div class="absolute top-2 right-2 flex items-center space-x-1">
<button class="w-6 h-6 bg-black bg-opacity-50 rounded flex items-center justify-center hover:bg-opacity-70 transition-colors" title="åˆ‡æ¢åˆ°ä¸»ä½ç½®" onclick="switchToMain('ai')">
<i class="ri-expand-diagonal-line text-white text-xs"></i>
</button>
</div>
</div>

<!-- ç”¨æˆ·æ‘„åƒå¤´å°çª— -->
<div id="user-video-secondary" class="w-full h-full relative bg-gray-800">
<video id="user-video-small" class="w-full h-full object-cover" autoplay muted></video>
<!-- å°çª—å­—å¹• -->
<div class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-70 p-2">
<p class="text-white text-xs leading-relaxed">é¢è¯•è€…</p>
</div>
<!-- å°çª—æ§åˆ¶ -->
<div class="absolute top-2 right-2 flex items-center space-x-1">
<button class="w-6 h-6 bg-black bg-opacity-50 rounded flex items-center justify-center hover:bg-opacity-70 transition-colors" title="åˆ‡æ¢åˆ°ä¸»ä½ç½®" onclick="switchToMain('user')">
<i class="ri-expand-diagonal-line text-white text-xs"></i>
</button>
<button class="w-6 h-6 bg-black bg-opacity-50 rounded flex items-center justify-center hover:bg-opacity-70 transition-colors" title="å…³é—­æ‘„åƒå¤´" onclick="toggleCamera(false)">
<i class="ri-camera-off-line text-white text-xs"></i>
</button>
</div>
</div>
</div>

<!-- é¢è¯•æ¶ˆæ¯å®¹å™¨ (éšè—ï¼Œç”¨äºå­˜å‚¨èŠå¤©è®°å½•) -->
<div id="chat-messages-container" class="hidden absolute inset-0 bg-white bg-opacity-95 backdrop-blur-sm overflow-y-auto p-6">
<div class="max-w-4xl mx-auto space-y-4">
<!-- æ¶ˆæ¯å°†é€šè¿‡JavaScriptåŠ¨æ€æ·»åŠ  -->
</div>
</div>

<!-- åˆ‡æ¢èŠå¤©è®°å½•æŒ‰é’® -->
<div class="absolute top-4 left-4 z-10">
<button id="toggle-chat-history" class="bg-black bg-opacity-50 text-white px-3 py-2 rounded-lg flex items-center space-x-2 hover:bg-opacity-70 transition-colors text-sm">
<i class="ri-chat-history-line"></i>
<span>æŸ¥çœ‹å¯¹è¯</span>
</button>
</div>
</div>
</div>
<!-- é¼ æ ‡æ„Ÿåº”åŒºåŸŸï¼ˆå³ä¾§è¾¹ç¼˜ï¼‰ -->
<div id="rightEdgeHover" class="fixed right-0 top-0 w-8 h-full z-40 pointer-events-auto"></div>

<!-- å±•å¼€åˆ†æé¢æ¿æŒ‰é’®ï¼ˆé¢æ¿æ”¶èµ·æ—¶æ˜¾ç¤ºï¼‰ -->
<div id="expandPanelButton" class="fixed right-0 top-1/2 transform -translate-y-1/2 z-50 opacity-0 translate-x-full transition-all duration-300 ease-out">
<button class="w-12 h-20 bg-primary text-white rounded-l-xl shadow-xl hover:bg-blue-600 transition-all duration-300 flex flex-col items-center justify-center group hover:shadow-2xl">
<i class="ri-arrow-left-line text-xl mb-1 group-hover:animate-pulse"></i>
<div class="text-xs leading-none">
<div>A</div>
<div>I</div>
<div>åˆ†</div>
<div>æ</div>
</div>
</button>
</div>

<!-- å³ä¾§å®æ—¶å¤šæ¨¡æ€åˆ†æé¢æ¿ -->
<div id="analysisPanel" class="w-96 bg-white shadow-lg border-l border-gray-200 overflow-y-auto">
<div class="p-6">
<div class="flex items-center justify-between mb-6">
<h2 class="text-lg font-semibold text-gray-800 flex items-center">
<div class="w-5 h-5 flex items-center justify-center mr-2">
<i class="ri-brain-line text-primary"></i>
</div>
AI æ•™ç»ƒåˆ†æ
</h2>
<div class="flex items-center space-x-2">
<div class="text-xs text-gray-500" data-analysis-status>å‡†å¤‡å°±ç»ª</div>
<button id="togglePanel" class="w-8 h-8 bg-gray-100 hover:bg-gray-200 rounded-lg flex items-center justify-center transition-colors duration-200">
<i class="ri-arrow-right-line text-gray-600"></i>
</button>
</div>
</div>

<!-- å¾®è¡¨æƒ…æ´å¯Ÿ -->
<div class="mb-6">
<h3 class="text-sm font-semibold text-gray-700 mb-3">
å¾®è¡¨æƒ…æ´å¯Ÿ
</h3>
<div class="space-y-2">
<div class="flex items-center justify-between p-3 bg-green-50 rounded-lg border border-green-100">
<span class="text-sm text-green-700">è‡ªä¿¡åº¦</span>
<span class="text-sm font-semibold text-green-600">85%</span>
</div>
<div class="flex items-center justify-between p-3 bg-yellow-50 rounded-lg border border-yellow-100">
<span class="text-sm text-yellow-700">ç´§å¼ åº¦</span>
<span class="text-sm font-semibold text-yellow-600">25%</span>
</div>
<div class="flex items-center justify-between p-3 bg-blue-50 rounded-lg border border-blue-100">
<span class="text-sm text-blue-700">ä¸“æ³¨åº¦</span>
<span class="text-sm font-semibold text-blue-600">92%</span>
</div>
</div>
</div>

<!-- ä½“æ€è¯­è¨€åˆ†æ -->
<div class="mb-6">
<h3 class="text-sm font-semibold text-gray-700 mb-3">
ä½“æ€è¯­è¨€åˆ†æ
</h3>
<div class="space-y-3">
<!-- çœ¼ç¥æ¥è§¦åˆ†æ -->
<div class="flex items-start space-x-2">
<div class="w-2 h-2 bg-green-400 rounded-full mt-2 eye-contact-indicator"></div>
<div>
<p class="text-sm text-gray-700 eye-contact-text">çœ¼ç¥æ¥è§¦è‰¯å¥½</p>
<p class="text-xs text-gray-500 eye-contact-desc">ä¿æŒäº† 78% çš„æ—¶é—´</p>
</div>
</div>
<!-- åå§¿/ä½“æ€åˆ†æ -->
<div class="flex items-start space-x-2">
<div class="w-2 h-2 bg-yellow-400 rounded-full mt-2 posture-indicator"></div>
<div>
<p class="text-sm text-gray-700 posture-text">åå§¿ç•¥æ˜¾ç´§å¼ </p>
<p class="text-xs text-gray-500 posture-desc">å»ºè®®æ”¾æ¾è‚©è†€</p>
</div>
</div>
<!-- æ‰‹åŠ¿åˆ†æ -->
<div class="flex items-start space-x-2">
<div class="w-2 h-2 bg-green-400 rounded-full mt-2 gesture-indicator"></div>
<div>
<p class="text-sm text-gray-700 gesture-text">æ‰‹åŠ¿è¡¨è¾¾è‡ªç„¶</p>
<p class="text-xs text-gray-500 gesture-desc">æœ‰æ•ˆè¾…åŠ©äº†è¯­è¨€è¡¨è¾¾</p>
</div>
</div>
<!-- è¯¦ç»†æ•°æ® (éšè—å…ƒç´ ï¼Œç”¨äºè°ƒè¯•) -->
<div class="hidden">
<span data-analysis="posture-score">75</span>
<span data-analysis="body-angle">0</span>
<span data-analysis="tension-level">25</span>
<span data-analysis="posture-type">sitting</span>
<span data-analysis="gesture-activity">0</span>
<span data-analysis="dominant-gesture">none</span>
<span data-analysis="hands-detected">false</span>
</div>

</div>
</div>

<!-- å®æ—¶è¯­è°ƒåˆ†æ -->
<div class="mb-6">
<div class="flex items-center justify-between mb-3">
<h3 class="text-sm font-semibold text-gray-700 flex items-center">
<i class="ri-waveform-line text-primary mr-1"></i>
å®æ—¶è¯­è°ƒåˆ†æ
</h3>
<div id="voice-tone-status" class="text-xs px-2 py-1 bg-gray-100 text-gray-600 rounded-full status-stopped">
æœªå¯åŠ¨
</div>
</div>



<!-- ç»¼åˆè¯­è°ƒå›¾è¡¨ -->
<div class="bg-white border border-gray-200 rounded-lg p-3">
<div class="flex items-center justify-between mb-2">
<div class="text-xs text-gray-600 font-medium">è¯­è°ƒå˜åŒ–è¶‹åŠ¿</div>
<div class="flex items-center space-x-3 text-xs">
<div class="flex items-center">
<div class="w-2 h-2 bg-red-500 rounded-full mr-1"></div>
<span class="text-gray-600">éŸ³é«˜</span>
</div>
<div class="flex items-center">
<div class="w-2 h-2 bg-blue-500 rounded-full mr-1"></div>
<span class="text-gray-600">éŸ³é‡</span>
</div>
<div class="flex items-center">
<div class="w-2 h-2 bg-yellow-500 rounded-full mr-1"></div>
<span class="text-gray-600">è¯­é€Ÿ</span>
</div>
</div>
</div>
<div class="h-40">
<canvas id="voice-tone-chart"></canvas>
</div>
</div>
</div>

<!-- å›ç­”è´¨é‡è¯„ä¼° -->
<div class="mb-6">
<h3 class="text-sm font-semibold text-gray-700 mb-3">
å›ç­”è´¨é‡è¯„ä¼°
</h3>
<div class="space-y-2">
<div class="flex items-center justify-between">
<span class="text-sm text-gray-600">é€»è¾‘æ€§</span>
<div class="flex items-center space-x-2">
<div class="w-16 h-2 bg-gray-200 rounded-full">
<div class="w-12 h-2 bg-primary rounded-full"></div>
</div>
<span class="text-xs text-gray-500">75%</span>
</div>
</div>
<div class="flex items-center justify-between">
<span class="text-sm text-gray-600">å®Œæ•´æ€§</span>
<div class="flex items-center space-x-2">
<div class="w-16 h-2 bg-gray-200 rounded-full">
<div class="w-14 h-2 bg-primary rounded-full"></div>
</div>
<span class="text-xs text-gray-500">88%</span>
</div>
</div>
<div class="flex items-center justify-between">
<span class="text-sm text-gray-600">ç›¸å…³æ€§</span>
<div class="flex items-center space-x-2">
<div class="w-16 h-2 bg-gray-200 rounded-full">
<div class="w-13 h-2 bg-primary rounded-full"></div>
</div>
<span class="text-xs text-gray-500">82%</span>
</div>
</div>
</div>
</div>

<!-- å³æ—¶ä¼˜åŒ–å»ºè®® -->
<div>
<h3 class="text-sm font-semibold text-gray-700 mb-3">
å³æ—¶ä¼˜åŒ–å»ºè®®
</h3>
<div class="space-y-2">
<div class="p-3 bg-blue-50 rounded-lg border border-blue-100">
<p class="text-sm text-blue-700">
å°è¯•ä½¿ç”¨ STAR æ³•åˆ™æ¥ç»“æ„åŒ–å›ç­”
</p>
</div>
<div class="p-3 bg-green-50 rounded-lg border border-green-100">
<p class="text-sm text-green-700">è¯­é€Ÿæ§åˆ¶å¾—å¾ˆå¥½ï¼Œç»§ç»­ä¿æŒ</p>
</div>
<div class="p-3 bg-yellow-50 rounded-lg border border-yellow-100">
<p class="text-sm text-yellow-700">
å¯ä»¥å¢åŠ ä¸€äº›å…·ä½“çš„æ•°æ®æ”¯æ’‘
</p>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- åº•éƒ¨æ§åˆ¶ä¸­å¿ƒ -->
<div class="bg-white border-t border-gray-100 px-6 py-4">
<div class="max-w-4xl mx-auto flex items-center justify-center space-x-8">
<!-- æ–‡ä»¶ä¸Šä¼  -->
<button class="w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center hover:bg-gray-200 transition-colors !rounded-button">
<i class="ri-attachment-line text-gray-600 text-lg"></i>
</button>
<!-- éº¦å…‹é£æ§åˆ¶ -->
<button class="w-16 h-16 bg-primary rounded-full flex items-center justify-center hover:bg-blue-600 transition-colors mic-pulse !rounded-button">
<i class="ri-mic-line text-white text-xl"></i>
</button>
<!-- æ–‡å­—è¾“å…¥ -->
<button class="w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center hover:bg-gray-200 transition-colors !rounded-button">
<i class="ri-keyboard-line text-gray-600 text-lg"></i>
</button>
<!-- ç»“æŸé¢è¯• -->
<button id="endInterviewBtn" class="px-6 py-3 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors flex items-center space-x-2 !rounded-button whitespace-nowrap">
<i class="ri-stop-circle-line"></i>
<span>ç»“æŸé¢è¯•</span>
</button>
</div>
<!-- çŠ¶æ€æŒ‡ç¤º -->
<div class="flex items-center justify-center mt-3 space-x-4 text-sm text-gray-500">
<div class="flex items-center space-x-1">
<div class="w-2 h-2 bg-green-500 rounded-full"></div>
<span>å½•éŸ³ä¸­</span>
</div>
<div class="flex items-center space-x-1">
<div class="w-2 h-2 bg-gray-500 rounded-full" data-status="analysis"></div>
<span data-status="analysis">AI åˆ†æå¾…å¯åŠ¨</span>
</div>
<div class="flex items-center space-x-1">
<i class="ri-time-line text-xs"></i>
<span>å·²è¿›è¡Œ 15:32</span>
</div>
</div>
</div>
<script id="progress-animation">
document.addEventListener('DOMContentLoaded', function() {
const breathingElements = document.querySelectorAll('.breathing');
breathingElements.forEach(element => {
element.style.animationDelay = Math.random() * 2 + 's';
});
});
</script>
<script id="mic-control">
document.addEventListener('DOMContentLoaded', function() {
// æ³¨æ„ï¼šè¿™ä¸ªè„šæœ¬ä»…ç”¨äºUIçŠ¶æ€æ˜¾ç¤º
// å®é™…çš„å½•éŸ³æ§åˆ¶é€»è¾‘ç”± langgraph-interview.js å¤„ç†
const micButton = document.querySelector('.mic-pulse');
console.log('ğŸ¤ éº¦å…‹é£æŒ‰é’®UIæ§åˆ¶å™¨å·²åŠ è½½ - å®é™…å½•éŸ³æ§åˆ¶ç”±LangGraphæ¨¡å—å¤„ç†');

// ä¿ç•™UIçŠ¶æ€åˆ‡æ¢é€»è¾‘ï¼ˆç”¨äºè§†è§‰åé¦ˆï¼‰
if (micButton) {
    micButton.addEventListener('click', function() {
        console.log('ğŸ¤ éº¦å…‹é£æŒ‰é’®ç‚¹å‡» - UIçŠ¶æ€å°†ç”±LangGraphæ¨¡å—æ›´æ–°');
        // æ³¨æ„ï¼šå®é™…çš„å½•éŸ³å¼€å§‹/åœæ­¢é€»è¾‘åœ¨ langgraph-interview.js ä¸­å¤„ç†
    });
}
});
</script>
<script id="panel-toggle">
document.addEventListener('DOMContentLoaded', function() {
const toggleButton = document.getElementById('togglePanel');
const analysisPanel = document.getElementById('analysisPanel');
const expandPanelButton = document.getElementById('expandPanelButton');
const rightEdgeHover = document.getElementById('rightEdgeHover');
let isPanelVisible = true; // é¢æ¿åˆå§‹çŠ¶æ€ä¸ºæ˜¾ç¤º
let hoverTimeout = null;

// æ˜¾ç¤ºå±•å¼€æŒ‰é’®
function showExpandButton() {
if (!isPanelVisible && expandPanelButton) {
expandPanelButton.style.opacity = '1';
expandPanelButton.style.transform = 'translateY(-50%) translateX(0)';
}
}

// éšè—å±•å¼€æŒ‰é’®
function hideExpandButton() {
if (expandPanelButton) {
expandPanelButton.style.opacity = '0';
expandPanelButton.style.transform = 'translateY(-50%) translateX(100%)';
}
}

// åˆ‡æ¢é¢æ¿æ˜¾ç¤ºçŠ¶æ€çš„å‡½æ•°
function togglePanel() {
isPanelVisible = !isPanelVisible;
const icon = toggleButton?.querySelector('i');

if (isPanelVisible) {
// æ˜¾ç¤ºé¢æ¿
analysisPanel.style.width = '24rem';
analysisPanel.style.display = 'block';
analysisPanel.style.opacity = '1';
analysisPanel.style.transition = 'all 0.3s ease';
if (icon) icon.className = 'ri-arrow-right-line text-gray-600';
// ç«‹å³éšè—å±•å¼€æŒ‰é’®
hideExpandButton();
console.log('æ•™ç»ƒåˆ†æé¢æ¿å·²æ‰“å¼€');
} else {
// éšè—é¢æ¿
analysisPanel.style.width = '0px';
analysisPanel.style.display = 'none';
analysisPanel.style.opacity = '0';
analysisPanel.style.transition = 'all 0.3s ease';
if (icon) icon.className = 'ri-arrow-left-line text-gray-600';
// é¢æ¿æ”¶èµ·åï¼Œå±•å¼€æŒ‰é’®å¤„äºå¾…å”¤å‡ºçŠ¶æ€ï¼ˆä½†ä»éšè—ï¼‰
console.log('æ•™ç»ƒåˆ†æé¢æ¿å·²å…³é—­ - é¼ æ ‡é è¿‘å³è¾¹ç¼˜å¯å”¤å‡ºå±•å¼€æŒ‰é’®');
}
}

// é¢æ¿å†…çš„åˆ‡æ¢æŒ‰é’®
if (toggleButton && analysisPanel) {
toggleButton.addEventListener('click', togglePanel);
}

// å±•å¼€æŒ‰é’®ç‚¹å‡»äº‹ä»¶
if (expandPanelButton && analysisPanel) {
expandPanelButton.addEventListener('click', function() {
if (!isPanelVisible) {
togglePanel();
}
});
}

// å³è¾¹ç¼˜hoveræ£€æµ‹
if (rightEdgeHover && expandPanelButton) {
// é¼ æ ‡è¿›å…¥å³è¾¹ç¼˜åŒºåŸŸ
rightEdgeHover.addEventListener('mouseenter', function() {
if (!isPanelVisible) {
clearTimeout(hoverTimeout);
showExpandButton();
}
});

// é¼ æ ‡ç¦»å¼€å³è¾¹ç¼˜åŒºåŸŸ
rightEdgeHover.addEventListener('mouseleave', function() {
if (!isPanelVisible) {
hoverTimeout = setTimeout(() => {
hideExpandButton();
}, 500); // 500mså»¶è¿Ÿéšè—ï¼Œç»™ç”¨æˆ·æ—¶é—´ç‚¹å‡»
}
});

// é¼ æ ‡è¿›å…¥å±•å¼€æŒ‰é’®åŒºåŸŸæ—¶å–æ¶ˆéšè—
expandPanelButton.addEventListener('mouseenter', function() {
if (!isPanelVisible) {
clearTimeout(hoverTimeout);
}
});

// é¼ æ ‡ç¦»å¼€å±•å¼€æŒ‰é’®åŒºåŸŸæ—¶å»¶è¿Ÿéšè—
expandPanelButton.addEventListener('mouseleave', function() {
if (!isPanelVisible) {
hoverTimeout = setTimeout(() => {
hideExpandButton();
}, 300);
}
});
}
});
</script>
<script id="video-stage-control">
document.addEventListener('DOMContentLoaded', function() {
// æ§åˆ¶å…ƒç´ 
const cameraToggle = document.getElementById('camera-toggle');
const modeSwitch = document.getElementById('mode-switch');
const secondaryStage = document.getElementById('secondary-stage');
const userVideo = document.getElementById('user-video');
const userVideoSmall = document.getElementById('user-video-small');

// å½“å‰çŠ¶æ€
let isCameraEnabled = false;
let isCodeMode = false;
let currentMainView = 'ai'; // 'ai', 'user', 'code'
let isRecording = false;
let userMediaStream = null;

// è§†é¢‘åˆ†æç®¡ç†å™¨
let videoAnalysisManager = null;

// æ‘„åƒå¤´åˆ‡æ¢
async function toggleCamera(enable = !isCameraEnabled) {
    try {
        if (enable && !userMediaStream) {
            // å¯ç”¨æ‘„åƒå¤´
            userMediaStream = await navigator.mediaDevices.getUserMedia({
                video: {
                    width: { ideal: 1280 },
                    height: { ideal: 720 },
                    facingMode: 'user'
                },
                audio: false // éŸ³é¢‘ç”±éº¦å…‹é£æ§åˆ¶å¤„ç†
            });
            
            userVideo.srcObject = userMediaStream;
            userVideoSmall.srcObject = userMediaStream;
            
            isCameraEnabled = true;
            cameraToggle.innerHTML = '<i class="ri-camera-fill text-gray-700"></i><span class="text-xs text-gray-700">å…³é—­æ‘„åƒå¤´</span>';
            
            // æ˜¾ç¤ºç”¨æˆ·æ‘„åƒå¤´å°çª—
            secondaryStage.classList.remove('hidden');
            document.getElementById('user-video-secondary').classList.remove('hidden');
            document.getElementById('ai-video-secondary').classList.add('hidden');
            
            // åˆå§‹åŒ–è§†é¢‘åˆ†æç®¡ç†å™¨
            await initializeVideoAnalysis();
            
            console.log('ğŸ“¹ ç”¨æˆ·æ‘„åƒå¤´å·²å¯ç”¨');
            
        } else if (!enable && userMediaStream) {
            // ç¦ç”¨æ‘„åƒå¤´
            userMediaStream.getTracks().forEach(track => track.stop());
            userMediaStream = null;
            
            // å…³é—­è§†é¢‘åˆ†æ
            await closeVideoAnalysis();
            
            isCameraEnabled = false;
            cameraToggle.innerHTML = '<i class="ri-camera-line text-gray-700"></i><span class="text-xs text-gray-700">æ‘„åƒå¤´</span>';
            
            // éšè—ç”¨æˆ·æ‘„åƒå¤´ï¼Œå¦‚æœå½“å‰ä¸»è§†å›¾æ˜¯ç”¨æˆ·åˆ™åˆ‡å›AI
            if (currentMainView === 'user') {
                switchToMain('ai');
            }
            
            // éšè—æ¬¡ä½ç½®ï¼ˆé™¤éæ˜¯ä»£ç æ¨¡å¼ï¼‰
            if (!isCodeMode) {
                secondaryStage.classList.add('hidden');
            }
            
            console.log('ğŸ“¹ ç”¨æˆ·æ‘„åƒå¤´å·²ç¦ç”¨');
        }
    } catch (error) {
        console.error('âŒ æ‘„åƒå¤´æ“ä½œå¤±è´¥:', error);
        alert('æ— æ³•è®¿é—®æ‘„åƒå¤´ï¼Œè¯·æ£€æŸ¥æƒé™è®¾ç½®');
    }
}

// æ¨¡å¼åˆ‡æ¢
function switchMode() {
    isCodeMode = !isCodeMode;
    
    if (isCodeMode) {
        // åˆ‡æ¢åˆ°ä»£ç æ¨¡å¼
        currentMainView = 'code';
        
        // éšè—æ‰€æœ‰è§†é¢‘ä¸»è§†å›¾
        document.getElementById('ai-video-main').classList.add('hidden');
        document.getElementById('user-video-main').classList.add('hidden');
        
        // æ˜¾ç¤ºä»£ç ç¼–è¾‘å™¨ä¸»è§†å›¾
        document.getElementById('code-editor-main').classList.remove('hidden');
        
        // æ˜¾ç¤ºAIæ•°å­—äººå°çª—
        secondaryStage.classList.remove('hidden');
        document.getElementById('ai-video-secondary').classList.remove('hidden');
        document.getElementById('user-video-secondary').classList.add('hidden');
        
        // æ›´æ–°æŒ‰é’®
        modeSwitch.innerHTML = '<i class="ri-video-line text-gray-700"></i><span class="text-sm text-gray-700 whitespace-nowrap">è§†é¢‘æ¨¡å¼</span>';
        
        // ç¡®ä¿Monacoç¼–è¾‘å™¨é‡æ–°å¸ƒå±€
        setTimeout(() => {
            if (window.webIDE && window.webIDE.editor) {
                window.webIDE.editor.layout();
            }
        }, 100);
        
        console.log('ğŸ’» åˆ‡æ¢åˆ°ä»£ç æ¨¡å¼');
        
    } else {
        // åˆ‡æ¢åˆ°è§†é¢‘æ¨¡å¼
        currentMainView = 'ai';
        
        // éšè—ä»£ç ç¼–è¾‘å™¨
        document.getElementById('code-editor-main').classList.add('hidden');
        
        // æ˜¾ç¤ºAIè§†é¢‘ä¸»è§†å›¾
        document.getElementById('ai-video-main').classList.remove('hidden');
        document.getElementById('user-video-main').classList.add('hidden');
        
        // æ›´æ–°æŒ‰é’®
        modeSwitch.innerHTML = '<i class="ri-code-line text-gray-700"></i><span class="text-sm text-gray-700 whitespace-nowrap">ä»£ç æ¨¡å¼</span>';
        
        // å¤„ç†æ¬¡ä½ç½®æ˜¾ç¤º
        if (isCameraEnabled) {
            secondaryStage.classList.remove('hidden');
            document.getElementById('user-video-secondary').classList.remove('hidden');
            document.getElementById('ai-video-secondary').classList.add('hidden');
        } else {
            secondaryStage.classList.add('hidden');
        }
        
        console.log('ğŸ“¹ åˆ‡æ¢åˆ°è§†é¢‘æ¨¡å¼');
    }
}

// ä¸»æ¬¡ä½ç½®åˆ‡æ¢
window.switchToMain = function(target) {
    if (isCodeMode) return; // ä»£ç æ¨¡å¼ä¸‹ä¸å…è®¸åˆ‡æ¢
    
    if (target === 'ai' && currentMainView !== 'ai') {
        // AIåˆ‡æ¢åˆ°ä¸»ä½ç½®
        currentMainView = 'ai';
        
        // æ˜¾ç¤ºAIä¸»è§†å›¾ï¼Œéšè—ç”¨æˆ·ä¸»è§†å›¾
        document.getElementById('ai-video-main').classList.remove('hidden');
        document.getElementById('user-video-main').classList.add('hidden');
        
        // æ›´æ–°æ¬¡ä½ç½®æ˜¾ç¤º
        if (isCameraEnabled) {
            document.getElementById('user-video-secondary').classList.remove('hidden');
            document.getElementById('ai-video-secondary').classList.add('hidden');
        }
        
        console.log('ğŸ¤– AIåˆ‡æ¢åˆ°ä¸»ä½ç½®');
        
    } else if (target === 'user' && currentMainView !== 'user' && isCameraEnabled) {
        // ç”¨æˆ·åˆ‡æ¢åˆ°ä¸»ä½ç½®
        currentMainView = 'user';
        
        // æ˜¾ç¤ºç”¨æˆ·ä¸»è§†å›¾ï¼Œéšè—AIä¸»è§†å›¾
        document.getElementById('user-video-main').classList.remove('hidden');
        document.getElementById('ai-video-main').classList.add('hidden');
        
        // æ›´æ–°æ¬¡ä½ç½®æ˜¾ç¤º
        document.getElementById('ai-video-secondary').classList.remove('hidden');
        document.getElementById('user-video-secondary').classList.add('hidden');
        
        console.log('ğŸ‘¤ ç”¨æˆ·åˆ‡æ¢åˆ°ä¸»ä½ç½®');
    }
};

// åŸºäºå½•éŸ³çŠ¶æ€è‡ªåŠ¨åˆ‡æ¢ä¸»æ¬¡ä½ç½®
window.updateMainViewByRecording = function(recording) {
    if (isCodeMode || !isCameraEnabled) return; // ä»£ç æ¨¡å¼æˆ–æ— æ‘„åƒå¤´æ—¶ä¸åˆ‡æ¢
    
    isRecording = recording;
    
    if (recording && currentMainView !== 'user') {
        // ç”¨æˆ·å¼€å§‹å½•éŸ³ï¼Œåˆ‡æ¢åˆ°ç”¨æˆ·ä¸»ä½ç½®
        switchToMain('user');
        // æ›´æ–°ç”¨æˆ·å­—å¹•
        document.getElementById('user-subtitle-text').textContent = 'æ­£åœ¨å›ç­”é—®é¢˜...';
    } else if (!recording && currentMainView !== 'ai') {
        // ç”¨æˆ·åœæ­¢å½•éŸ³ï¼Œåˆ‡æ¢åˆ°AIä¸»ä½ç½®
        switchToMain('ai');
    }
};

// å…¨å±€æ‘„åƒå¤´æ§åˆ¶å‡½æ•°
window.toggleCamera = toggleCamera;

// äº‹ä»¶ç»‘å®š
if (cameraToggle) {
    cameraToggle.addEventListener('click', () => toggleCamera());
}

if (modeSwitch) {
    modeSwitch.addEventListener('click', switchMode);
}

console.log('ğŸ¬ è§†é¢‘èˆå°æ§åˆ¶å™¨å·²åŠ è½½');

// === è§†é¢‘åˆ†æç›¸å…³å‡½æ•° ===

/**
 * åˆå§‹åŒ–è§†é¢‘åˆ†æ
 */
async function initializeVideoAnalysis() {
    if (!window.VideoAnalysisManager) {
        console.error('âŒ VideoAnalysisManageræœªåŠ è½½');
        return;
    }
    
    try {
        // è·å–ç”¨æˆ·IDï¼ˆä»è®¤è¯ç®¡ç†å™¨æˆ–å…¨å±€å˜é‡ï¼‰
        let userId = 'user_demo'; // é»˜è®¤å€¼
        if (window.AuthManager && typeof window.AuthManager.getCurrentUser === 'function') {
            const currentUser = window.AuthManager.getCurrentUser();
            if (currentUser && currentUser.user_id) {
                userId = currentUser.user_id;
            }
        }
        
        // åˆ›å»ºè§†é¢‘åˆ†æç®¡ç†å™¨å®ä¾‹
        videoAnalysisManager = new window.VideoAnalysisManager();
        
        // åˆå§‹åŒ– - é€‰æ‹©å½“å‰å¯è§å’Œå¯ç”¨çš„è§†é¢‘å…ƒç´ 
        let videoElement = null;
        
        // ä¼˜å…ˆé€‰æ‹©ä¸»è§†é¢‘å…ƒç´ ï¼ˆå¦‚æœå¯è§ï¼‰
        const mainVideo = document.getElementById('user-video');
        const smallVideo = document.getElementById('user-video-small');
        
        console.log('ğŸ” æ£€æŸ¥è§†é¢‘å…ƒç´ çŠ¶æ€:');
        console.log('ä¸»è§†é¢‘å…ƒç´ :', {
            exists: !!mainVideo,
            srcObject: mainVideo ? !!mainVideo.srcObject : false,
            visible: mainVideo ? mainVideo.offsetWidth > 0 && mainVideo.offsetHeight > 0 : false,
            display: mainVideo ? getComputedStyle(mainVideo).display : 'none'
        });
        console.log('å°è§†é¢‘å…ƒç´ :', {
            exists: !!smallVideo,
            srcObject: smallVideo ? !!smallVideo.srcObject : false,
            visible: smallVideo ? smallVideo.offsetWidth > 0 && smallVideo.offsetHeight > 0 : false,
            display: smallVideo ? getComputedStyle(smallVideo).display : 'none'
        });
        
        // é€‰æ‹©æœ‰åª’ä½“æµçš„è§†é¢‘å…ƒç´ ï¼Œä¼˜å…ˆé€‰æ‹©å°è§†é¢‘ï¼ˆé€šå¸¸åœ¨å³ä¸Šè§’æ˜¾ç¤ºï¼‰
        if (smallVideo && smallVideo.srcObject) {
            videoElement = smallVideo;
            console.log('ğŸ“¹ é€‰æ‹©å°è§†é¢‘å…ƒç´  (user-video-small)');
        } else if (mainVideo && mainVideo.srcObject) {
            videoElement = mainVideo;
            console.log('ğŸ“¹ é€‰æ‹©ä¸»è§†é¢‘å…ƒç´  (user-video)');
        }
        
        if (!videoElement) {
            console.error('âŒ æ‰¾ä¸åˆ°å¯ç”¨çš„è§†é¢‘å…ƒç´ ');
            return;
        }
        
        const initialized = await videoAnalysisManager.initialize(userId, videoElement);
        if (!initialized) {
            console.error('âŒ è§†é¢‘åˆ†æç®¡ç†å™¨åˆå§‹åŒ–å¤±è´¥');
            return;
        }
        
        // åˆ›å»ºåˆ†æä¼šè¯
        const sessionId = await videoAnalysisManager.createSession(userId);
        if (!sessionId) {
            console.error('âŒ åˆ›å»ºè§†é¢‘åˆ†æä¼šè¯å¤±è´¥');
            return;
        }
        
        // è¿æ¥WebSocket
        const connected = await videoAnalysisManager.connectWebSocket(sessionId);
        if (!connected) {
            console.error('âŒ è¿æ¥è§†é¢‘åˆ†æWebSocketå¤±è´¥');
            return;
        }
        
        console.log('âœ… è§†é¢‘åˆ†æç®¡ç†å™¨åˆå§‹åŒ–æˆåŠŸ');
        
        // è‡ªåŠ¨å¼€å§‹åˆ†æ
        setTimeout(async () => {
            if (videoAnalysisManager && isCameraEnabled) {
                await videoAnalysisManager.startAnalysis();
            }
        }, 2000); // ç­‰å¾…2ç§’è®©æ‘„åƒå¤´ç¨³å®š
        
    } catch (error) {
        console.error('âŒ åˆå§‹åŒ–è§†é¢‘åˆ†æå¤±è´¥:', error);
    }
}

/**
 * å…³é—­è§†é¢‘åˆ†æ
 */
async function closeVideoAnalysis() {
    if (videoAnalysisManager) {
        try {
            await videoAnalysisManager.close();
            videoAnalysisManager = null;
            console.log('âœ… è§†é¢‘åˆ†æå·²å…³é—­');
        } catch (error) {
            console.error('âŒ å…³é—­è§†é¢‘åˆ†æå¤±è´¥:', error);
        }
    }
}

/**
 * åˆ‡æ¢è§†é¢‘åˆ†æçŠ¶æ€
 */
async function toggleVideoAnalysis() {
    if (!videoAnalysisManager) {
        console.error('âŒ è§†é¢‘åˆ†æç®¡ç†å™¨æœªåˆå§‹åŒ–');
        return;
    }
    
    try {
        if (videoAnalysisManager.isAnalyzing) {
            await videoAnalysisManager.stopAnalysis();
            console.log('â¹ï¸ è§†é¢‘åˆ†æå·²åœæ­¢');
        } else {
            await videoAnalysisManager.startAnalysis();
            console.log('â–¶ï¸ è§†é¢‘åˆ†æå·²å¼€å§‹');
        }
    } catch (error) {
        console.error('âŒ åˆ‡æ¢è§†é¢‘åˆ†æçŠ¶æ€å¤±è´¥:', error);
    }
}

/**
 * è·å–å½“å‰åˆ†æç»“æœ
 */
function getCurrentVideoAnalysis() {
    if (videoAnalysisManager) {
        return videoAnalysisManager.getCurrentAnalysis();
    }
    return null;
}

// å…¨å±€å‡½æ•°å¯¼å‡º
window.videoAnalysisFunctions = {
    initializeVideoAnalysis,
    closeVideoAnalysis,
    toggleVideoAnalysis,
    getCurrentVideoAnalysis
};

});
</script>

<!-- è¯­è°ƒåˆ†æé›†æˆè„šæœ¬ -->
<script id="voiceToneAnalysisIntegration">
// å…¨å±€è¯­è°ƒåˆ†æå™¨å®ä¾‹
let globalVoiceToneAnalyzer = null;

document.addEventListener("DOMContentLoaded", function () {
    console.log('ğŸ¼ åˆå§‹åŒ–è¯­è°ƒåˆ†æé›†æˆ');
    
    // åˆ›å»ºè¯­è°ƒåˆ†æå™¨å®ä¾‹
    globalVoiceToneAnalyzer = new VoiceToneAnalyzer();
});

/**
 * å¯åŠ¨è¯­è°ƒåˆ†æ
 * @param {string} sessionId - è¯­éŸ³ä¼šè¯ID
 */
function startVoiceToneAnalysis(sessionId) {
    try {
        console.log('ğŸ¼ å¯åŠ¨è¯­è°ƒåˆ†æ:', sessionId);
        if (globalVoiceToneAnalyzer) {
            globalVoiceToneAnalyzer.initialize(sessionId).then(success => {
                if (success) {
                    globalVoiceToneAnalyzer.startAnalysis();
                    console.log('âœ… è¯­è°ƒåˆ†æå¯åŠ¨æˆåŠŸ');
                } else {
                    console.error('âŒ è¯­è°ƒåˆ†æå¯åŠ¨å¤±è´¥');
                }
            });
        }
    } catch (error) {
        console.error('âŒ å¯åŠ¨è¯­è°ƒåˆ†æå¤±è´¥:', error);
    }
}

/**
 * åœæ­¢è¯­è°ƒåˆ†æ
 */
function stopVoiceToneAnalysis() {
    try {
        console.log('ğŸ›‘ åœæ­¢è¯­è°ƒåˆ†æ');
        if (globalVoiceToneAnalyzer) {
            globalVoiceToneAnalyzer.stopAnalysis();
        }
    } catch (error) {
        console.error('âŒ åœæ­¢è¯­è°ƒåˆ†æå¤±è´¥:', error);
    }
}

/**
 * å¤„ç†æ¥è‡ªWebSocketçš„è¯­è°ƒåˆ†ææ•°æ®
 * @param {Object} data - è¯­è°ƒåˆ†ææ•°æ®
 */
function handleVoiceToneAnalysis(data) {
    try {
        if (globalVoiceToneAnalyzer) {
            globalVoiceToneAnalyzer.processAnalysisData(data);
        }
    } catch (error) {
        console.error('âŒ å¤„ç†è¯­è°ƒåˆ†ææ•°æ®å¤±è´¥:', error);
    }
}

/**
 * æµ‹è¯•ä½“æ€è¯­è¨€åˆ†æåŠŸèƒ½
 */
function testBodyLanguageAnalysis() {
    console.log('ğŸ§ª å¼€å§‹æµ‹è¯•ä½“æ€è¯­è¨€åˆ†æåŠŸèƒ½');
    
    // æ¨¡æ‹Ÿåç«¯å‘é€çš„åˆ†ææ•°æ®
    const testData = {
        body_language: {
            posture_score: Math.floor(Math.random() * 100),
            body_angle: Math.floor(Math.random() * 30) - 15,
            tension_level: Math.floor(Math.random() * 100),
            posture_type: 'sitting',
            eye_contact_ratio: Math.floor(Math.random() * 100)
        },
        gestures: {
            gesture_activity: Math.floor(Math.random() * 100),
            dominant_gesture: ['none', 'pointing', 'open_palm', 'thumbs_up'][Math.floor(Math.random() * 4)],
            hands_detected: Math.floor(Math.random() * 3)
        },
        timestamp: Date.now()
    };
    
    console.log('ğŸ§ª æµ‹è¯•æ•°æ®:', testData);
    
    // æŸ¥æ‰¾ä½“æ€è¯­è¨€åˆ†æå™¨å¹¶æµ‹è¯•
    if (window.videoAnalysisManager && window.videoAnalysisManager.bodyLanguageAnalyzer) {
        console.log('âœ… æ‰¾åˆ°ä½“æ€è¯­è¨€åˆ†æå™¨ï¼Œå¼€å§‹æµ‹è¯•');
        window.videoAnalysisManager.bodyLanguageAnalyzer.processAnalysisData(testData);
    } else {
        console.log('âš ï¸ æœªæ‰¾åˆ°ä½“æ€è¯­è¨€åˆ†æå™¨ï¼Œå°è¯•æ‰‹åŠ¨åˆ›å»º');
        
        // æ‰‹åŠ¨åˆ›å»ºå¹¶æµ‹è¯•
        if (window.BodyLanguageAnalyzer) {
            const testAnalyzer = new window.BodyLanguageAnalyzer();
            testAnalyzer.startAnalysis();
            testAnalyzer.processAnalysisData(testData);
        } else {
            console.error('âŒ BodyLanguageAnalyzerç±»æœªåŠ è½½');
        }
    }
}
</script>
<script src="js/code-editor.js"></script>
<script>
// åˆå§‹åŒ–Web IDE
document.addEventListener('DOMContentLoaded', function() {
    // ç­‰å¾…æ¨¡å¼åˆ‡æ¢ç³»ç»Ÿåˆå§‹åŒ–åå†åˆå§‹åŒ–IDE
    setTimeout(() => {
        if (window.webIDE) {
            window.webIDE.init().catch(error => {
                console.error('Web IDE åˆå§‹åŒ–å¤±è´¥:', error);
            });
        }
    }, 1000);
});
</script>
    <!-- å¯¼å…¥LangGraphé…ç½® -->
    <script src="./js/langgraph-config.js"></script>
    <!-- å¯¼å…¥LangGraphé¢è¯•ç³»ç»Ÿ -->
    <script src="./js/langgraph-interview.js"></script>
    <!-- å¯¼å…¥è§†é¢‘åˆ†æç®¡ç†å™¨ -->
    <script src="./js/video-analysis-manager.js"></script>
    <!-- å¯¼å…¥å¯¼èˆªæ ç»„ä»¶ -->
    <script src="./components/navbar.js"></script>
        <!-- è®¤è¯ç®¡ç†å™¨ï¼ˆå¿…é¡»é¦–å…ˆåŠ è½½ï¼‰ -->
        <script src="./js/auth-manager.js"></script>
        <!-- é¢è¯•å®Œæˆå’ŒæŠ¥å‘Šç”Ÿæˆ -->
        <script src="./js/interview-completion.js"></script>
        <!-- è¯­è°ƒåˆ†æå™¨æ ·å¼ -->
        <style>
            /* è¯­è°ƒåˆ†æçŠ¶æ€æŒ‡ç¤ºå™¨ */
            .status-indicator {
                border-radius: 9999px;
                padding: 2px 8px;
                font-size: 0.75rem;
            }
            .status-normal {
                background-color: #dcfce7;
                color: #166534;
            }
            .status-low {
                background-color: #fef3c7;
                color: #d97706;
            }
            .status-high {
                background-color: #fee2e2;
                color: #dc2626;
            }
            
            /* è¯­è°ƒåˆ†æé¢æ¿çŠ¶æ€ */
            .status-analyzing {
                background-color: #dbeafe;
                color: #1d4ed8;
                animation: pulse 2s infinite;
            }
            .status-stopped {
                background-color: #f3f4f6;
                color: #6b7280;
            }
            
            @keyframes pulse {
                0%, 100% { opacity: 1; }
                50% { opacity: 0.7; }
            }
            
            /* Chart.js å›¾è¡¨å®¹å™¨æ ·å¼ */
            #voice-tone-chart {
                height: 100% !important;
                max-height: 160px !important;
            }
        </style>
        
        <!-- è¯­è°ƒåˆ†æå™¨è„šæœ¬ -->
        <script src="./js/voice-tone-analyzer.js"></script>
        <!-- ä½“æ€è¯­è¨€åˆ†æå™¨è„šæœ¬ -->
        <script src="./js/body-language-analyzer.js"></script>
        
        <!-- é¢æ¿åˆ‡æ¢è„šæœ¬ -->
        <script src="./js/panel-toggle.js"></script>
      
    
</body>
</html></html>
