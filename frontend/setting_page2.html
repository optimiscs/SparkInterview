<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ™ºèƒ½é¢è¯•åŠ©æ‰‹ - ç®€å†è§£æ</title>
<script src="https://cdn.tailwindcss.com/3.4.16"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css">
<script>
tailwind.config = {
theme: {
extend: {
colors: {
primary: '#3b82f6',
secondary: '#6366f1'
},
borderRadius: {
'none': '0px',
'sm': '4px',
DEFAULT: '8px',
'md': '12px',
'lg': '16px',
'xl': '20px',
'2xl': '24px',
'3xl': '32px',
'full': '9999px',
'button': '8px'
}
}
}
}
</script>
<style>
:where([class^="ri-"])::before {
content: "\f3c2";
}
.progress-bar {
transition: width 0.3s ease;
}
.fade-in {
animation: fadeIn 0.5s ease-in;
}
@keyframes fadeIn {
from { opacity: 0; transform: translateY(10px); }
to { opacity: 1; transform: translateY(0); }
}
.skill-tag {
transition: all 0.2s ease;
}
.skill-tag:hover {
transform: translateY(-1px);
box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
</style>
</head>
<body class="bg-gray-50 min-h-screen">
<div class="flex h-screen flex-col">
<!-- å¯¼èˆªæ å®¹å™¨ - ç»„ä»¶ä¼šè‡ªåŠ¨æ’å…¥åˆ°è¿™é‡Œ -->
    <div id="navbar-container"></div>
<!-- ä¸»è¦å†…å®¹åŒº -->
<div class="flex-1 flex overflow-hidden bg-gray-50">
<!-- å·¦ä¾§ä¸»è¦å†…å®¹åŒº -->
<div class="flex-1 flex flex-col overflow-hidden">
<div class="bg-white border-b border-gray-200 px-8 py-6">
<h1 class="text-2xl font-bold text-gray-900">ç®€å†è§£æ</h1>
<p class="text-gray-600 mt-1">ç³»ç»Ÿæ­£åœ¨è°ƒç”¨Spark Proæ™ºèƒ½è§£ææ‚¨çš„ç®€å†ï¼Œæå–å…³é”®ä¿¡æ¯å’ŒæŠ€èƒ½ç‚¹</p>
</div>
<!-- è¿›åº¦æŒ‡ç¤ºå™¨ -->
<div class="bg-white border-b border-gray-200 px-8 py-4">
<div class="flex items-center justify-between">
<div class="flex items-center">
<div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center text-white text-sm font-medium">
<i class="ri-check-line"></i>
</div>
<span class="ml-2 text-sm font-medium text-green-600">åŸºç¡€ä¿¡æ¯</span>
</div>
<div class="flex-1 mx-4 h-px bg-green-300"></div>
<div class="flex items-center">
<div class="w-8 h-8 bg-primary rounded-full flex items-center justify-center text-white text-sm font-medium">2</div>
<span class="ml-2 text-sm font-medium text-primary">ç®€å†è§£æ</span>
</div>
<div class="flex-1 mx-4 h-px bg-gray-300"></div>
<div class="flex items-center">
<div class="w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center text-gray-500 text-sm font-medium">3</div>
<span class="ml-2 text-sm text-gray-500">é¢˜ç›®ç”Ÿæˆ</span>
</div>
</div>
</div>
<div class="flex-1 flex overflow-hidden">
<!-- ç®€å†é¢„è§ˆåŒº -->
<div class="flex-1 p-8 overflow-y-auto">
<div class="bg-white rounded-xl shadow-sm border border-gray-200 h-full">
<div class="p-6 border-b border-gray-200 flex items-center justify-between">
<h3 class="text-lg font-semibold text-gray-900">ç®€å†é¢„è§ˆ</h3>
<div class="flex items-center space-x-2">
<button class="p-2 text-gray-400 hover:text-gray-600">
<div class="w-5 h-5 flex items-center justify-center">
<i class="ri-zoom-out-line"></i>
</div>
</button>
<span class="text-sm text-gray-500">100%</span>
<button class="p-2 text-gray-400 hover:text-gray-600">
<div class="w-5 h-5 flex items-center justify-center">
<i class="ri-zoom-in-line"></i>
</div>
</button>
</div>
</div>
<div class="p-6 flex-1 bg-gray-50">
<div class="bg-white rounded-lg shadow-sm p-8 max-w-2xl mx-auto" style="min-height: 800px;" id="resumePreview">
<div class="text-center mb-8">
<h1 class="text-3xl font-bold text-gray-900 mb-2" id="resumeName">è«æ ©</h1>
<p class="text-lg text-gray-600 mb-4" id="resumePosition">ç®—æ³•å·¥ç¨‹å¸ˆ</p>
<div class="flex justify-center space-x-6 text-sm text-gray-600">
<div class="flex items-center" id="resumePhone">
<i class="ri-phone-line mr-1"></i>
13480805647
</div>
<div class="flex items-center" id="resumeEmail">
<i class="ri-mail-line mr-1"></i>
2022302181277@whu.edu.cn
</div>
<div class="flex items-center" id="resumeCity">
<i class="ri-map-pin-line mr-1"></i>
æ­¦æ±‰å¸‚
</div>
</div>
</div>
<div class="space-y-8">
<div>
<h2 class="text-xl font-semibold text-gray-900 mb-4 border-b-2 border-primary pb-2">å·¥ä½œç»å†</h2>
<div class="space-y-6" id="resumeExperience">
<div>
<div class="flex justify-between items-start mb-2">
<h3 class="text-lg font-medium text-gray-900">æ­¦æ±‰å¤§å­¦ - å­¦ç”Ÿ</h3>
<span class="text-sm text-gray-600">2022.09 - 2026.06</span>
</div>
<ul class="text-gray-700 space-y-1 ml-4">
<li>â€¢ å¤§æ¨¡å‹å¾®è°ƒçš„å®‰å…¨å¯¹é½ç ”ç©¶</li>
<li>â€¢ èˆ†æƒ…åˆ†æç³»ç»Ÿå¼€å‘</li>
<li>â€¢ åˆ›æ–°å‘æ˜ä¸çŸ¥è¯†äº§æƒåä¼šå‰¯ä¼šé•¿</li>
</ul>
</div>
<div>
<div class="flex justify-between items-start mb-2">
<h3 class="text-lg font-medium text-gray-900">ç”µå•†ç”µç¾¤ - åˆ›ä¸šè€…</h3>
<span class="text-sm text-gray-600">2023.06 - è‡³ä»Š</span>
</div>
<ul class="text-gray-700 space-y-1 ml-4">
<li>â€¢ å›¢é˜Ÿç®¡ç†ï¼šç»„å»º9äººè·¨èŒèƒ½å›¢é˜Ÿ</li>
<li>â€¢ æ•ˆç‡ä¼˜åŒ–ï¼šå¼•å…¥æ™ºèƒ½å‘è´§æœºå™¨äºº</li>
<li>â€¢ è§„æ¨¡æ‹“å±•ï¼šè¿è¥ä¸ƒä¸ªåº—é“ºï¼ŒæœåŠ¡è¶…äºŒåä¸‡ç”¨æˆ·</li>
</ul>
</div>
</div>
</div>
<div>
<h2 class="text-xl font-semibold text-gray-900 mb-4 border-b-2 border-primary pb-2">é¡¹ç›®ç»éªŒ</h2>
<div class="space-y-4" id="resumeProjects">
<div>
<h3 class="text-lg font-medium text-gray-900 mb-2">å¤§æ¨¡å‹å¾®è°ƒçš„å®‰å…¨å¯¹é½ç ”ç©¶</h3>
<p class="text-gray-700 mb-2">æˆåŠŸå¤ç°ICLRçš„å…³é”®ç»“è®ºï¼Œé‡‡ç”¨GPT-4oå¯¹ç›®æ ‡å¤§è¯­è¨€æ¨¡å‹è¾“å‡ºè¿›è¡Œç²¾ç»†åŒ–å®‰å…¨æ€§é‡åŒ–è¯„ä¼°</p>
<p class="text-sm text-gray-600">æŠ€æœ¯æ ˆï¼šPython, PyTorch, GPT-4o, å®‰å…¨è¯„ä¼°</p>
</div>
<div>
<h3 class="text-lg font-medium text-gray-900 mb-2">èˆ†æƒ…åˆ†æç³»ç»Ÿ</h3>
<p class="text-gray-700 mb-2">å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œæ”¯æŒå®æ—¶æƒ…æ„Ÿåˆ†æå’Œçƒ­ç‚¹äº‹ä»¶æ£€æµ‹</p>
<p class="text-sm text-gray-600">æŠ€æœ¯æ ˆï¼šReact, FastAPI, Redis, MongoDB, Docker</p>
</div>
<div>
<h3 class="text-lg font-medium text-gray-900 mb-2">ç”µå•†ç”µç¾¤è¿è¥</h3>
<p class="text-gray-700 mb-2">ä»é›¶å¼€å§‹å­µåŒ–å¹¶è¿è¥ä¸ƒä¸ªåº—é“ºï¼Œå½¢æˆåº—ç¾¤æ•ˆåº”ï¼ŒCç«¯è¥æ”¶çªç ´ç™¾ä¸‡</p>
<p class="text-sm text-gray-600">æŠ€æœ¯æ ˆï¼šå›¢é˜Ÿç®¡ç†, è‡ªåŠ¨åŒ–ç³»ç»Ÿ, æ•°æ®åˆ†æ</p>
</div>
</div>
</div>
<div>
<h2 class="text-xl font-semibold text-gray-900 mb-4 border-b-2 border-primary pb-2">æŠ€èƒ½ä¸“é•¿</h2>
<div class="grid grid-cols-2 gap-4" id="resumeSkills">
<div>
<h4 class="font-medium text-gray-900 mb-2">ç¼–ç¨‹è¯­è¨€</h4>
<p class="text-gray-700">Python, JavaScript, Java</p>
</div>
<div>
<h4 class="font-medium text-gray-900 mb-2">æ¡†æ¶å·¥å…·</h4>
<p class="text-gray-700">PyTorch, Springboot, React, FastAPI</p>
</div>
<div>
<h4 class="font-medium text-gray-900 mb-2">æ•°æ®åº“</h4>
<p class="text-gray-700">Redis, MongoDB, MySQL</p>
</div>
<div>
<h4 class="font-medium text-gray-900 mb-2">å…¶ä»–å·¥å…·</h4>
<p class="text-gray-700">Docker, Git, Linux</p>
</div>
</div>
</div>
<div>
<h2 class="text-xl font-semibold text-gray-900 mb-4 border-b-2 border-primary pb-2">æ•™è‚²èƒŒæ™¯</h2>
<div>
<div class="flex justify-between items-start mb-2">
<h3 class="text-lg font-medium text-gray-900">æ­¦æ±‰å¤§å­¦ - ç½‘ç»œç©ºé—´å®‰å…¨</h3>
<span class="text-sm text-gray-600">2022.09 - 2026.06</span>
</div>
<p class="text-gray-700">æœ¬ç§‘ | GPA: 3.72/4.0</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- è§£æè¿›åº¦åŒº -->
<div class="w-96 bg-white border-l border-gray-200 p-6 overflow-y-auto">
<h3 class="text-lg font-semibold text-gray-900 mb-6">è§£æè¿›åº¦</h3>
<!-- æ€»ä½“è¿›åº¦ -->
<div class="mb-8">
<div class="flex items-center justify-between mb-2">
<span class="text-sm font-medium text-gray-700">æ•´ä½“è¿›åº¦</span>
<span class="text-sm text-primary font-medium" id="overallProgress">100%</span>
</div>
<div class="w-full bg-gray-200 rounded-full h-2">
<div class="bg-primary h-2 rounded-full progress-bar" id="overallBar" style="width: 100%"></div>
</div>
</div>
<!-- å„æ¨¡å—è¿›åº¦ -->
<div class="space-y-6">
<div class="fade-in">
<div class="flex items-center mb-3">
<div class="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center mr-3">
<i class="ri-check-line text-white text-sm"></i>
</div>
<h4 class="text-sm font-medium text-gray-900">åŸºæœ¬ä¿¡æ¯æå–</h4>
</div>
<div class="ml-9 text-xs text-gray-600 space-y-1" id="basicInfoDetails">
<p>âœ“ å§“åï¼šè«æ ©</p>
<p>âœ“ è”ç³»æ–¹å¼ï¼šå·²æå–</p>
<p>âœ“ å·¥ä½œå¹´é™ï¼š2 å¹´</p>
</div>
</div>
<div class="fade-in">
<div class="flex items-center mb-3">
<div class="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center mr-3">
<i class="ri-check-line text-white text-sm"></i>
</div>
<h4 class="text-sm font-medium text-gray-900">æŠ€èƒ½ç‚¹è¯†åˆ«</h4>
</div>
<div class="ml-9" id="skillsDetails">
<div class="flex flex-wrap gap-1 mb-2" id="skillsTags">
<span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded skill-tag">Python</span>
<span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded skill-tag">PyTorch</span>
<span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded skill-tag">Springboot</span>
<span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded skill-tag">React</span>
<span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded skill-tag">Docker</span>
<span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded skill-tag">FastAPI</span>
<span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded skill-tag">Redis</span>
<span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded skill-tag">MongoDB</span>
</div>
<p class="text-xs text-gray-600" id="skillsCount">å·²è¯†åˆ« 8 ä¸ªæ ¸å¿ƒæŠ€èƒ½</p>
</div>
</div>
<div class="fade-in">
<div class="flex items-center mb-3">
<div class="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center mr-3">
<i class="ri-check-line text-white text-sm"></i>
</div>
<h4 class="text-sm font-medium text-gray-900">é¡¹ç›®ç»éªŒæå–</h4>
</div>
<div class="ml-9 space-y-3" id="projectsDetails">
<div class="bg-gray-50 rounded-lg p-3">
<h5 class="text-sm font-medium text-gray-900">å¤§æ¨¡å‹å¾®è°ƒçš„å®‰å…¨å¯¹é½ç ”ç©¶</h5>
<p class="text-xs text-gray-600 mt-1">AIå®‰å…¨ â€¢ æ¨¡å‹å¾®è°ƒ â€¢ å®‰å…¨è¯„ä¼°</p>
<div class="flex items-center mt-2 text-xs text-green-600">
<i class="ri-time-line mr-1"></i>
2025.03 - è‡³ä»Š
</div>
</div>
<div class="bg-gray-50 rounded-lg p-3">
<h5 class="text-sm font-medium text-gray-900">èˆ†æƒ…åˆ†æç³»ç»Ÿ</h5>
<p class="text-xs text-gray-600 mt-1">å‰åç«¯åˆ†ç¦» â€¢ æƒ…æ„Ÿåˆ†æ â€¢ å®æ—¶æ£€æµ‹</p>
<div class="flex items-center mt-2 text-xs text-green-600">
<i class="ri-time-line mr-1"></i>
2024.11 - è‡³ä»Š
</div>
</div>
<div class="bg-gray-50 rounded-lg p-3">
<h5 class="text-sm font-medium text-gray-900">ç”µå•†ç”µç¾¤è¿è¥</h5>
<p class="text-xs text-gray-600 mt-1">å›¢é˜Ÿç®¡ç† â€¢ è‡ªåŠ¨åŒ–ç³»ç»Ÿ â€¢ æ•°æ®åˆ†æ</p>
<div class="flex items-center mt-2 text-xs text-green-600">
<i class="ri-time-line mr-1"></i>
2023.06 - è‡³ä»Š
</div>
</div>
</div>
</div>
<div class="fade-in">
<div class="flex items-center mb-3">
<div class="w-6 h-6 bg-green-500 rounded-full flex items-center justify-center mr-3">
<i class="ri-check-line text-white text-sm"></i>
</div>
<h4 class="text-sm font-medium text-gray-900">å·¥ä½œç»å†åˆ†æ</h4>
</div>
<div class="ml-9 space-y-3">
<div class="border-l-2 border-primary pl-4">
<div class="flex items-center justify-between mb-1">
<h5 class="text-sm font-medium text-gray-900">ç™¾åº¦</h5>
<span class="text-xs text-gray-500">2021.03 - è‡³ä»Š</span>
</div>
<p class="text-xs text-gray-600 mb-2">é«˜çº§ç®—æ³•å·¥ç¨‹å¸ˆ</p>
<div class="space-y-1 text-xs text-gray-600">
<p>â€¢ æ¨èç³»ç»Ÿç®—æ³•ä¼˜åŒ–</p>
<p>â€¢ æ·±åº¦å­¦ä¹ æ¨¡å‹ç ”å‘</p>
<p>â€¢ æœºå™¨å­¦ä¹ å¹³å°æ¶æ„</p>
</div>
</div>
<div class="border-l-2 border-gray-300 pl-4">
<div class="flex items-center justify-between mb-1">
<h5 class="text-sm font-medium text-gray-900">è…¾è®¯</h5>
<span class="text-xs text-gray-500">2019.07 - 2021.02</span>
</div>
<p class="text-xs text-gray-600 mb-2">ç®—æ³•å·¥ç¨‹å¸ˆ</p>
<div class="space-y-1 text-xs text-gray-600">
<p>â€¢ ååŒè¿‡æ»¤ç®—æ³•å¼€å‘</p>
<p>â€¢ æ¨¡å‹è®­ç»ƒä¼˜åŒ–</p>
<p>â€¢ A/B æµ‹è¯•å¹³å°</p>
</div>
</div>
</div>
</div>
</div>
<!-- è§£æç»“æœæ‘˜è¦ -->
<div class="mt-8 bg-green-50 rounded-lg p-4">
<div class="flex items-center mb-3">
<div class="w-5 h-5 flex items-center justify-center mr-2">
<i class="ri-check-double-line text-green-600"></i>
</div>
<h4 class="text-sm font-medium text-green-900">è§£æå®Œæˆ</h4>
</div>
<div class="text-xs text-green-700 space-y-1">
<p>â€¢ è¯†åˆ«æŠ€èƒ½ç‚¹ï¼š15 ä¸ª</p>
<p>â€¢ æå–é¡¹ç›®ç»éªŒï¼š3 ä¸ª</p>
<p>â€¢ åˆ†æå·¥ä½œç»å†ï¼š2 æ®µ</p>
<p>â€¢ åŒ¹é…åº¦è¯„åˆ†ï¼š92%</p>
</div>
</div>
<!-- æ“ä½œæŒ‰é’® -->
<div class="flex flex-col space-y-3 mt-8">
<button class="w-full px-4 py-2 text-primary border border-primary rounded-button hover:bg-primary/5 whitespace-nowrap !rounded-button" id="reAnalyze">
<div class="w-4 h-4 flex items-center justify-center mr-2 inline-block">
<i class="ri-refresh-line"></i>
</div>
é‡æ–°è§£æ
</button>
<button class="w-full px-4 py-2 text-gray-600 border border-gray-300 rounded-button hover:bg-gray-50 whitespace-nowrap !rounded-button" id="exportResult">
<div class="w-4 h-4 flex items-center justify-center mr-2 inline-block">
<i class="ri-download-line"></i>
</div>
å¯¼å‡ºç»“æœ
</button>

<button class="w-full px-4 py-3 bg-primary text-white rounded-button hover:bg-primary/90 whitespace-nowrap !rounded-button" id="nextStep">
<div class="w-4 h-4 flex items-center justify-center mr-2 inline-block">
<i class="ri-arrow-right-line"></i>
</div>
ä¸‹ä¸€æ­¥ï¼šç”Ÿæˆé¢˜ç›®
</button>

</div>
</div>
</div>
</div>
</div>
<script id="analysis-loader">
// ç»Ÿä¸€çš„åˆ†æç»“æœåŠ è½½å™¨
const AnalysisLoader = {
  // åˆå§‹åŒ–
  async init() {
    // æ£€æŸ¥ç™»å½•çŠ¶æ€
    const token = localStorage.getItem('access_token');
    if (!token) {
      window.location.href = '/frontend/login.html';
      return;
    }

    // è·å–ç”¨æˆ·ä¿¡æ¯
    await this.fetchUserInfo();
    
    // è·å–åˆ†æç»“æœ
    await this.loadAnalysisResult();
  },

  // è·å–ç”¨æˆ·ä¿¡æ¯
  async fetchUserInfo() {
    const token = localStorage.getItem('access_token');
    if (!token) return;
    
    try {
      const resp = await fetch('/api/v1/profile', {
        headers: { 'Authorization': 'Bearer ' + token }
      });
      
      if (!resp.ok) throw new Error('è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥');
      
      const user = await resp.json();
      this.renderUserInfo(user);
    } catch (error) {
      console.error('è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:', error);
      localStorage.removeItem('access_token');
      window.location.href = '/frontend/login.html';
    }
  },

  // æ¸²æŸ“ç”¨æˆ·ä¿¡æ¯
  renderUserInfo(user) {
    const userInfoDiv = document.querySelector('.flex.items-center:last-child');
    if (userInfoDiv && user) {
      userInfoDiv.innerHTML = `
        <div class="w-8 h-8 bg-primary rounded-full flex items-center justify-center overflow-hidden">
          ${user.avatar_url ? 
            `<img src="${user.avatar_url}" class="w-full h-full object-cover" alt="å¤´åƒ">` : 
            `<i class="ri-user-line text-white"></i>`}
        </div>
        <div class="ml-2">
          <p class="text-sm font-medium text-gray-900">${user.name || 'æœªçŸ¥ç”¨æˆ·'}</p>
          <p class="text-xs text-gray-500">${user.role === 'admin' ? 'ç®¡ç†å‘˜' : user.role === 'teacher' ? 'æ•™å¸ˆ' : 'å­¦ç”Ÿ'}</p>
        </div>
      `;
    }
  },

  // åŠ è½½åˆ†æç»“æœ
  async loadAnalysisResult() {
    // ä»URLå‚æ•°è·å–taskId
const urlParams = new URLSearchParams(window.location.search);
const taskId = urlParams.get('taskId');

    if (!taskId) {
      this.showError('ç¼ºå°‘ä»»åŠ¡IDå‚æ•°ï¼Œè¯·ä»ç®€å†é…ç½®é¡µé¢é‡æ–°å¼€å§‹');
      return;
}

    console.log('ğŸ” å¼€å§‹è·å–åˆ†æç»“æœï¼ŒTaskID:', taskId);
    
    try {
      // æ£€æŸ¥æ˜¯å¦æ˜¯æµ‹è¯•æ¨¡å¼ï¼ˆtaskIdä»¥test_å¼€å¤´ï¼‰
      if (taskId.startsWith('test_task_')) {
        console.log('ğŸ§ª æ£€æµ‹åˆ°æµ‹è¯•æ¨¡å¼ï¼Œå°è¯•ä»localStorageè·å–æ¨¡æ‹Ÿæ•°æ®');
        const mockData = localStorage.getItem('mock_analysis_' + taskId);
        
        if (mockData) {
          const result = JSON.parse(mockData);
          console.log('ğŸ“Š æˆåŠŸè·å–æµ‹è¯•æ•°æ®:', result);
          this.displayAnalysisResults(result);
          return;
} else {
          throw new Error('æµ‹è¯•æ•°æ®ä¸å­˜åœ¨ï¼Œè¯·å…ˆè¿è¡Œæµ‹è¯•å·¥å…·åˆ›å»ºæ¨¡æ‹Ÿæ•°æ®');
}
      }

      // æ­£å¸¸æ¨¡å¼ï¼šè°ƒç”¨åç«¯API
      console.log('ğŸŒ æ­£å¸¸æ¨¡å¼ï¼Œè°ƒç”¨åç«¯APIè·å–åˆ†æç»“æœ');
      const statusResp = await fetch(`/api/v1/resume/status/${taskId}`);
      
      if (!statusResp.ok) {
        throw new Error(`HTTPé”™è¯¯: ${statusResp.status} ${statusResp.statusText}`);
}
      
      const statusData = await statusResp.json();

      if (!statusData.success) {
        throw new Error(statusData.error || 'è·å–ä»»åŠ¡çŠ¶æ€å¤±è´¥');
      }

      if (statusData.status !== 'completed') {
        this.showError(`ä»»åŠ¡æœªå®Œæˆï¼Œå½“å‰çŠ¶æ€ï¼š${statusData.status}`);
return;
}

      // è·å–åˆ†æç»“æœ
      console.log('âœ… ä»»åŠ¡å·²å®Œæˆï¼Œå¼€å§‹è·å–åˆ†æç»“æœ');
      const result = statusData.result;
      
      if (result) {
        console.log('ğŸ“Š æˆåŠŸè·å–åˆ†æç»“æœ:', result);
        this.displayAnalysisResults(result);
} else {
        throw new Error('åˆ†æç»“æœä¸ºç©º');
}

    } catch (error) {
      console.error('âŒ è·å–åˆ†æç»“æœå¤±è´¥:', error);
      this.showError('è·å–åˆ†æç»“æœå¤±è´¥: ' + error.message + 'ã€‚å¦‚æœæ˜¯æµ‹è¯•æ¨¡å¼ï¼Œè¯·ç¡®ä¿å…ˆè¿è¡Œæµ‹è¯•å·¥å…·åˆ›å»ºæ¨¡æ‹Ÿæ•°æ®ã€‚');
}
  },

  // æ˜¾ç¤ºåˆ†æç»“æœ
  displayAnalysisResults(data) {
    console.log('ğŸ¨ å¼€å§‹æ¸²æŸ“åˆ†æç»“æœ');
    
    // æ›´æ–°åŸºæœ¬ä¿¡æ¯
    if (data.basic_info) {
      this.updateResumePreview(data.basic_info);
      this.updateBasicInfoDetails(data.basic_info);  // ğŸ†• æ›´æ–°å³ä¾§åŸºæœ¬ä¿¡æ¯æå–åŒºåŸŸ
}

    // æ›´æ–°å·¥ä½œç»å†
if (data.experience && data.experience.length > 0) {
      this.updateResumeExperience(data.experience);
      this.updateWorkExperienceDetails(data.experience);  // ğŸ†• æ›´æ–°å³ä¾§å·¥ä½œç»å†åˆ†æåŒºåŸŸ
}

    // æ›´æ–°é¡¹ç›®ç»éªŒ
if (data.projects && data.projects.length > 0) {
      this.updateResumeProjects(data.projects);
      this.updateProjectsDetails(data.projects);  // ä¿æŒåŸæœ‰åŠŸèƒ½
}

    // æ›´æ–°æ•™è‚²èƒŒæ™¯
    if (data.education) {
      this.updateResumeEducation(data.education);
    }

    // æ›´æ–°æŠ€èƒ½åˆ†ç±»
if (data.skills_categories) {
      this.updateResumeSkills(data.skills_categories);
}

    // æ›´æ–°å³ä¾§æŠ€èƒ½ç‚¹æ˜¾ç¤º
    if (data.skills && data.skills.length > 0) {
      this.updateSkillsTags(data.skills);
    }

    // æ›´æ–°åˆ†ææ‘˜è¦
    if (data.analysis) {
      this.updateAnalysisSummary(data.analysis, data);  // ğŸ†• ä¼ å…¥å®Œæ•´æ•°æ®ç”¨äºç»Ÿè®¡
}

    // æ˜¾ç¤ºå®ŒæˆçŠ¶æ€
    this.showCompletedStatus();
  },

  // æ›´æ–°ç®€å†é¢„è§ˆ
  updateResumePreview(basicInfo) {
const nameElement = document.getElementById('resumeName');
if (nameElement && basicInfo.name) {
nameElement.textContent = basicInfo.name;
}

const positionElement = document.getElementById('resumePosition');
if (positionElement && basicInfo.current_position) {
positionElement.textContent = basicInfo.current_position;
}

const phoneElement = document.getElementById('resumePhone');
if (phoneElement && basicInfo.phone) {
phoneElement.innerHTML = `<i class="ri-phone-line mr-1"></i>${basicInfo.phone}`;
}

const emailElement = document.getElementById('resumeEmail');
if (emailElement && basicInfo.email) {
emailElement.innerHTML = `<i class="ri-mail-line mr-1"></i>${basicInfo.email}`;
}

const cityElement = document.getElementById('resumeCity');
if (cityElement && basicInfo.city) {
cityElement.innerHTML = `<i class="ri-map-pin-line mr-1"></i>${basicInfo.city}`;
}
  },

  // æ›´æ–°å·¥ä½œç»å†
  updateResumeExperience(experience) {
const experienceContainer = document.getElementById('resumeExperience');
if (experienceContainer && experience && experience.length > 0) {
experienceContainer.innerHTML = '';
experience.forEach(exp => {
const expDiv = document.createElement('div');
expDiv.innerHTML = `
<div class="flex justify-between items-start mb-2">
<h3 class="text-lg font-medium text-gray-900">${exp.company} - ${exp.position}</h3>
<span class="text-sm text-gray-600">${exp.period}</span>
</div>
<ul class="text-gray-700 space-y-1 ml-4">
${exp.responsibilities.map(resp => `<li>â€¢ ${resp}</li>`).join('')}
</ul>
`;
experienceContainer.appendChild(expDiv);
});
}
  },

  // æ›´æ–°é¡¹ç›®ç»éªŒ
  updateResumeProjects(projects) {
const projectsContainer = document.getElementById('resumeProjects');
if (projectsContainer && projects && projects.length > 0) {
projectsContainer.innerHTML = '';
projects.forEach(project => {
const projectDiv = document.createElement('div');
projectDiv.innerHTML = `
<h3 class="text-lg font-medium text-gray-900 mb-2">${project.name}</h3>
<p class="text-gray-700 mb-2">${project.description}</p>
<p class="text-sm text-gray-600">æŠ€æœ¯æ ˆï¼š${project.tech_stack}</p>
`;
projectsContainer.appendChild(projectDiv);
});
}
  },

  // æ›´æ–°æ•™è‚²èƒŒæ™¯
  updateResumeEducation(education) {
    const educationContainer = document.querySelector('#resumePreview .space-y-8 > div:last-child');
    if (educationContainer && education) {
      educationContainer.innerHTML = `
        <h2 class="text-xl font-semibold text-gray-900 mb-4 border-b-2 border-primary pb-2">æ•™è‚²èƒŒæ™¯</h2>
        <div>
          <div class="flex justify-between items-start mb-2">
            <h3 class="text-lg font-medium text-gray-900">${education.school} - ${education.major}</h3>
            <span class="text-sm text-gray-600">${education.graduation_year}</span>
          </div>
          <p class="text-gray-700">${education.degree}${education.gpa ? ` | GPA: ${education.gpa}` : ''}</p>
        </div>
      `;
    }
  },

  // æ›´æ–°æŠ€èƒ½åˆ†ç±»
  updateResumeSkills(skillsCategories) {
const skillsContainer = document.getElementById('resumeSkills');
if (skillsContainer && skillsCategories) {
const skillSections = [
{ title: 'ç¼–ç¨‹è¯­è¨€', skills: skillsCategories.programming_languages || [] },
{ title: 'æ¡†æ¶å·¥å…·', skills: skillsCategories.frameworks || [] },
{ title: 'æ•°æ®åº“', skills: skillsCategories.databases || [] },
{ title: 'å…¶ä»–å·¥å…·', skills: skillsCategories.tools || [] }
];

skillsContainer.innerHTML = '';
skillSections.forEach(section => {
if (section.skills.length > 0) {
const sectionDiv = document.createElement('div');
sectionDiv.innerHTML = `
<h4 class="font-medium text-gray-900 mb-2">${section.title}</h4>
<p class="text-gray-700">${section.skills.join(', ')}</p>
`;
skillsContainer.appendChild(sectionDiv);
}
});
}
  },

  // æ›´æ–°å³ä¾§æŠ€èƒ½æ ‡ç­¾
  updateSkillsTags(skills) {
    const skillsContainer = document.getElementById('skillsTags');
    if (skillsContainer) {
      skillsContainer.innerHTML = '';
      skills.slice(0, 10).forEach(skill => { // æœ€å¤šæ˜¾ç¤º10ä¸ªæŠ€èƒ½
const skillTag = document.createElement('span');
skillTag.className = 'px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded skill-tag';
skillTag.textContent = skill;
        skillsContainer.appendChild(skillTag);
      });
      
      // æ›´æ–°æŠ€èƒ½æ•°é‡
const skillsCount = document.getElementById('skillsCount');
if (skillsCount) {
        skillsCount.textContent = `å·²è¯†åˆ« ${skills.length} ä¸ªæ ¸å¿ƒæŠ€èƒ½`;
}
}
  },

  // æ›´æ–°å³ä¾§é¡¹ç›®è¯¦æƒ…
  updateProjectsDetails(projects) {
    const projectsContainer = document.getElementById('projectsDetails');
    if (projectsContainer) {
      projectsContainer.innerHTML = '';
      projects.forEach(project => {
const projectDiv = document.createElement('div');
projectDiv.className = 'bg-gray-50 rounded-lg p-3';
projectDiv.innerHTML = `
<h5 class="text-sm font-medium text-gray-900">${project.name}</h5>
          <p class="text-xs text-gray-600 mt-1">${project.description}</p>
<div class="flex items-center mt-2 text-xs text-green-600">
<i class="ri-time-line mr-1"></i>
${project.period || ''}
</div>
`;
        projectsContainer.appendChild(projectDiv);
});
}
  },

// ğŸ†• æ›´æ–°åŸºæœ¬ä¿¡æ¯æå–åŒºåŸŸ
  updateBasicInfoDetails(basicInfo) {
    const basicInfoContainer = document.getElementById('basicInfoDetails');
    if (basicInfoContainer && basicInfo) {
      basicInfoContainer.innerHTML = `
        <p>âœ“ å§“åï¼š${basicInfo.name || 'æœªè¯†åˆ«'}</p>
        <p>âœ“ è”ç³»æ–¹å¼ï¼š${basicInfo.phone && basicInfo.email ? 'å·²æå–' : 'éƒ¨åˆ†æå–'}</p>
        <p>âœ“ å·¥ä½œå¹´é™ï¼š${basicInfo.experience_years || 'æœªè¯†åˆ«'}</p>
        <p>âœ“ å½“å‰èŒä½ï¼š${basicInfo.current_position || 'æœªè¯†åˆ«'}</p>
        <p>âœ“ æ‰€åœ¨åŸå¸‚ï¼š${basicInfo.city || 'æœªè¯†åˆ«'}</p>
      `;
    }
  },

  // ğŸ†• æ›´æ–°å·¥ä½œç»å†åˆ†æåŒºåŸŸ
  updateWorkExperienceDetails(experience) {
    const experienceContainer = document.querySelector('.ml-9.space-y-3');
    if (experienceContainer && experience && experience.length > 0) {
      experienceContainer.innerHTML = '';
      
      experience.forEach((exp, index) => {
        const expDiv = document.createElement('div');
        expDiv.className = index === 0 ? 'border-l-2 border-primary pl-4' : 'border-l-2 border-gray-300 pl-4';
        
        expDiv.innerHTML = `
          <div class="flex items-center justify-between mb-1">
            <h5 class="text-sm font-medium text-gray-900">${exp.company}</h5>
            <span class="text-xs text-gray-500">${exp.period}</span>
          </div>
          <p class="text-xs text-gray-600 mb-2">${exp.position}</p>
          <div class="space-y-1 text-xs text-gray-600">
            ${exp.responsibilities.map(resp => `<p>â€¢ ${resp}</p>`).join('')}
          </div>
        `;
        
        experienceContainer.appendChild(expDiv);
      });
    }
  },

// ğŸ†• æ›´æ–°åˆ†ææ‘˜è¦ï¼ˆå¢å¼ºç‰ˆï¼‰
  updateAnalysisSummary(analysis, fullData) {
    const summaryContainer = document.querySelector('.bg-green-50.rounded-lg');
    if (summaryContainer && analysis && fullData) {
      const detailsList = summaryContainer.querySelector('.space-y-1');
      if (detailsList) {
        // è®¡ç®—çœŸå®ç»Ÿè®¡æ•°æ®
        const skillsCount = fullData.skills ? fullData.skills.length : 0;
        const projectsCount = fullData.projects ? fullData.projects.length : 0;
        const experienceCount = fullData.experience ? fullData.experience.length : 0;
        const overallMatch = analysis.overall_match || 0;
        
        detailsList.innerHTML = `
          <p>â€¢ è¯†åˆ«æŠ€èƒ½ç‚¹ï¼š${skillsCount} ä¸ª</p>
          <p>â€¢ æå–é¡¹ç›®ç»éªŒï¼š${projectsCount} ä¸ª</p>
          <p>â€¢ åˆ†æå·¥ä½œç»å†ï¼š${experienceCount} æ®µ</p>
          <p>â€¢ åŒ¹é…åº¦è¯„åˆ†ï¼š${overallMatch}%</p>
        `;
      }
    }
  },

  // æ˜¾ç¤ºå®ŒæˆçŠ¶æ€
  showCompletedStatus() {
    // æ›´æ–°è¿›åº¦ä¸º100%
    const overallProgress = document.getElementById('overallProgress');
    const overallBar = document.getElementById('overallBar');
    
    if (overallProgress) overallProgress.textContent = '100%';
    if (overallBar) overallBar.style.width = '100%';

    console.log('âœ¨ åˆ†æç»“æœæ¸²æŸ“å®Œæˆ');
  },

  // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
  showError(message) {
    const errorDialog = document.createElement('div');
    errorDialog.className = 'fixed inset-0 flex items-center justify-center z-50';
    errorDialog.innerHTML = `
<div class="fixed inset-0 bg-black/50"></div>
<div class="relative bg-white rounded-lg p-6 max-w-sm w-full mx-4">
        <div class="flex items-center mb-4">
          <div class="w-10 h-10 bg-red-100 rounded-full flex items-center justify-center mr-3">
            <i class="ri-error-warning-line text-red-600"></i>
          </div>
          <h3 class="text-lg font-medium text-gray-900">åŠ è½½å¤±è´¥</h3>
        </div>
        <p class="text-gray-600 mb-4">${message}</p>
        <div class="flex space-x-3">
          <button class="flex-1 px-4 py-2 text-gray-600 border border-gray-300 rounded-button hover:bg-gray-50" onclick="window.location.href='./setting_page1.html'">è¿”å›é…ç½®</button>
          <button class="flex-1 px-4 py-2 bg-primary text-white rounded-button hover:bg-primary/90" onclick="location.reload()">é‡æ–°åŠ è½½</button>
        </div>
</div>
`;
    document.body.appendChild(errorDialog);
  }
};

// é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', () => {
  AnalysisLoader.init();
  
  // ğŸ†• åˆå§‹åŒ–ä¸‹ä¸€æ­¥æŒ‰é’®äº‹ä»¶
  initNextStepButton();
});

// ğŸ†• åˆå§‹åŒ–ä¸‹ä¸€æ­¥æŒ‰é’®åŠŸèƒ½
function initNextStepButton() {
  const nextStepBtn = document.getElementById('nextStep');
  if (nextStepBtn) {
    nextStepBtn.addEventListener('click', handleNextStepClick);
  }
}

// ğŸ†• å¤„ç†ä¸‹ä¸€æ­¥æŒ‰é’®ç‚¹å‡»äº‹ä»¶
function handleNextStepClick(e) {
  e.preventDefault();
  
  // ä»URLå‚æ•°è·å–taskId
  const urlParams = new URLSearchParams(window.location.search);
  const taskId = urlParams.get('taskId');
  
  console.log('ğŸ” ä¸‹ä¸€æ­¥æŒ‰é’®è¢«ç‚¹å‡»ï¼ŒTaskID:', taskId);
  
  if (!taskId) {
    showDialog('æç¤º', 'ç¼ºå°‘ä»»åŠ¡IDï¼Œè¯·ä»ç®€å†é…ç½®é¡µé¢é‡æ–°å¼€å§‹ï¼');
    return;
  }
  
  // æ„é€ è·³è½¬URLï¼Œå¸¦ä¸ŠtaskIdå‚æ•°
  const nextPageUrl = `./setting_page3.html?taskId=${taskId}`;
  console.log('âœ… å‡†å¤‡è·³è½¬åˆ°:', nextPageUrl);
  
  // æ‰§è¡Œé¡µé¢è·³è½¬
  window.location.href = nextPageUrl;
}

// ğŸ†• æ˜¾ç¤ºå¯¹è¯æ¡†çš„è¾…åŠ©å‡½æ•°
function showDialog(title, message) {
  const dialog = document.createElement('div');
  dialog.className = 'fixed inset-0 flex items-center justify-center z-50';
  dialog.innerHTML = `
    <div class="fixed inset-0 bg-black/50"></div>
    <div class="relative bg-white rounded-lg p-6 max-w-sm w-full mx-4">
      <h3 class="text-lg font-medium text-gray-900 mb-2">${title}</h3>
      <p class="text-gray-600 mb-4">${message}</p>
      <button class="w-full px-4 py-2 bg-primary text-white rounded-button" onclick="this.closest('.fixed').remove()">ç¡®å®š</button>
    </div>
  `;
  document.body.appendChild(dialog);
}


</script>

    <!-- å¯¼å…¥å¯¼èˆªæ ç»„ä»¶ -->
    <script src="./components/navbar.js"></script>
</body>
</html>